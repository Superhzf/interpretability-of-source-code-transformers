Getting activations from json files. If you need to extract them, run with --extract=True 

Anayzing pretrained_BERT
Loading json activations from bert_activations_train.json...
1289 13.0
Number of tokens:  1042
length of source dictionary:  1042
length of target dictionary:  34
1042
Total instances: 1042
['utmpent', 'Tab', '300', 'hide_flexnics', 'MAXUSERS', 'django', 'else', 'shts', 'SECOND_MICROS', 'kls', 'credential', 'root', 'conn_list', 'powerRequest', 'openstack', 'material', 'IndexTabs', '_closed', 'open', 'MAX_MSG_SIZE']
Number of samples:  1042
Stats: Labels with their frequencies in the final set
NAME 876
STRING 72
NUMBER 36
KEYWORD 25
COMMENT 4
NL 1
LPAR 1
DOT 1
RPAR 1
COLON 1
EQUAL 1
COMMA 1
INDENT 1
DEDENT 1
LSQB 1
RSQB 1
AT 1
STAR 1
EQEQUAL 1
MINUS 1
PLUS 1
PERCENT 1
GREATER 1
NOTEQUAL 1
PLUSEQUAL 1
GREATEREQUAL 1
LESS 1
MINEQUAL 1
LBRACE 1
RBRACE 1
LESSEQUAL 1
DOUBLESTAR 1
SLASH 1
SEMI 1
pretrained_BERT distribution:
{0: 876, 1: 72, 2: 36, 3: 25, 4: 4, 5: 1, 6: 1, 7: 1, 8: 1, 9: 1, 10: 1, 11: 1, 12: 1, 13: 1, 14: 1, 15: 1, 16: 1, 17: 1, 18: 1, 19: 1, 20: 1, 21: 1, 22: 1, 23: 1, 24: 1, 25: 1, 26: 1, 27: 1, 28: 1, 29: 1, 30: 1, 31: 1, 32: 1, 33: 1}
pretrained_BERT distribution after trauncating:
{0: 0.8681863230921705, 1: 0.07135777998017839, 2: 0.035678889990089196, 3: 0.024777006937561942}
{0: 876, 1: 72, 2: 36, 3: 25}
{'NAME': 0, 'STRING': 1, 'NUMBER': 2, 'KEYWORD': 3}
Loading json activations from bert_activations_test.json...
494 13.0
Number of tokens:  482
length of source dictionary:  482
length of target dictionary:  33
482
Total instances: 482
['Layer', 'else', 'b1_h', 'coeff', 'desired_result_0', 'sigma', 'incomings', 'net', 'epsilon', 'c', 'small_tmp', 'TestElemwiseMergeLayerMul', 'source_suffix', 'term4', 'toolbox', 'outs', 'input_layers', 'default', '__class__', 'MultiStep']
Number of samples:  482
Stats: Labels with their frequencies in the final set
NAME 400
NUMBER 27
KEYWORD 22
STRING 4
COMMA 1
NEWLINE 1
DOT 1
LPAR 1
RPAR 1
EQUAL 1
COLON 1
DEDENT 1
INDENT 1
LBRACE 1
RBRACE 1
LSQB 1
RSQB 1
MINUS 1
SLASH 1
AT 1
EQEQUAL 1
GREATER 1
STAREQUAL 1
LESS 1
DOUBLESTAR 1
STAR 1
PLUS 1
COMMENT 1
GREATEREQUAL 1
PLUSEQUAL 1
LESSEQUAL 1
PERCENT 1
AMPER 1
pretrained_BERT distribution:
{0: 400, 1: 27, 2: 22, 3: 4, 4: 1, 5: 1, 6: 1, 7: 1, 8: 1, 9: 1, 10: 1, 11: 1, 12: 1, 13: 1, 14: 1, 15: 1, 16: 1, 17: 1, 18: 1, 19: 1, 20: 1, 21: 1, 22: 1, 23: 1, 24: 1, 25: 1, 26: 1, 27: 1, 28: 1, 29: 1, 30: 1, 31: 1, 32: 1}
pretrained_BERT distribution after trauncating:
{0: 0.8830022075055187, 1: 0.059602649006622516, 2: 0.04856512141280353, 3: 0.008830022075055188}
{0: 400, 1: 27, 2: 22, 3: 4}
{'NAME': 0, 'NUMBER': 1, 'KEYWORD': 2, 'STRING': 3}
Training classification probe
Creating model...
Number of training instances: 908
Number of classes: 4
Epoch: [1/10], Loss: 0.0144
Epoch: [2/10], Loss: 0.0064
Epoch: [3/10], Loss: 0.0036
Epoch: [4/10], Loss: 0.0022
Epoch: [5/10], Loss: 0.0010
Epoch: [6/10], Loss: 0.0006
Epoch: [7/10], Loss: 0.0003
Epoch: [8/10], Loss: 0.0002
Epoch: [9/10], Loss: 0.0002
Epoch: [10/10], Loss: 0.0001
Score (accuracy) of the probe: 0.98
Training classification probe
Creating model...
Number of training instances: 908
Number of classes: 4
Epoch: [1/10], Loss: 0.0147
Epoch: [2/10], Loss: 0.0064
Epoch: [3/10], Loss: 0.0037
Epoch: [4/10], Loss: 0.0024
Epoch: [5/10], Loss: 0.0011
Epoch: [6/10], Loss: 0.0007
Epoch: [7/10], Loss: 0.0003
Epoch: [8/10], Loss: 0.0003
Epoch: [9/10], Loss: 0.0002
Epoch: [10/10], Loss: 0.0002
Score (accuracy) of the probe: 0.98
Training classification probe
Creating model...
Number of training instances: 908
Number of classes: 4
Epoch: [1/10], Loss: 0.0141
Epoch: [2/10], Loss: 0.0062
Epoch: [3/10], Loss: 0.0036
Epoch: [4/10], Loss: 0.0025
Epoch: [5/10], Loss: 0.0011
Epoch: [6/10], Loss: 0.0007
Epoch: [7/10], Loss: 0.0005
Epoch: [8/10], Loss: 0.0004
Epoch: [9/10], Loss: 0.0003
Epoch: [10/10], Loss: 0.0003
Score (accuracy) of the probe: 0.98
Training classification probe
Creating model...
Number of training instances: 908
Number of classes: 4
Epoch: [1/10], Loss: 0.0157
Epoch: [2/10], Loss: 0.0072
Epoch: [3/10], Loss: 0.0048
Epoch: [4/10], Loss: 0.0036
Epoch: [5/10], Loss: 0.0024
Epoch: [6/10], Loss: 0.0020
Epoch: [7/10], Loss: 0.0017
Epoch: [8/10], Loss: 0.0017
Epoch: [9/10], Loss: 0.0016
Epoch: [10/10], Loss: 0.0016
Score (accuracy) of the probe: 0.97
The best l1=0, the best l2=0 for pretrained_BERT
Accuracy on the test set of probing pretrained_BERT of all layers:
Score (accuracy) of the probe: 0.86
{'__OVERALL__': 0.8631346578366446, 'NAME': 0.845, 'STRING': 1.0, 'NUMBER': 1.0, 'KEYWORD': 1.0}
Accuracy on the test set of pretrained_BERT model using the intercept:
Score (accuracy) of the probe: 0.88
pretrained_BERT Layer 0
Training classification probe
Creating model...
Number of training instances: 908
Number of classes: 4
Epoch: [1/10], Loss: 0.0131
Epoch: [2/10], Loss: 0.0103
Epoch: [3/10], Loss: 0.0092
Epoch: [4/10], Loss: 0.0084
Epoch: [5/10], Loss: 0.0077
Epoch: [6/10], Loss: 0.0071
Epoch: [7/10], Loss: 0.0065
Epoch: [8/10], Loss: 0.0061
Epoch: [9/10], Loss: 0.0057
Epoch: [10/10], Loss: 0.0054
Score (accuracy) of the probe: 0.78
Training classification probe
Creating model...
Number of training instances: 908
Number of classes: 4
Epoch: [1/10], Loss: 0.0130
Epoch: [2/10], Loss: 0.0101
Epoch: [3/10], Loss: 0.0092
Epoch: [4/10], Loss: 0.0083
Epoch: [5/10], Loss: 0.0076
Epoch: [6/10], Loss: 0.0070
Epoch: [7/10], Loss: 0.0065
Epoch: [8/10], Loss: 0.0061
Epoch: [9/10], Loss: 0.0057
Epoch: [10/10], Loss: 0.0053
Score (accuracy) of the probe: 0.82
Training classification probe
Creating model...
Number of training instances: 908
Number of classes: 4
Epoch: [1/10], Loss: 0.0129
Epoch: [2/10], Loss: 0.0102
Epoch: [3/10], Loss: 0.0093
Epoch: [4/10], Loss: 0.0084
Epoch: [5/10], Loss: 0.0077
Epoch: [6/10], Loss: 0.0071
Epoch: [7/10], Loss: 0.0066
Epoch: [8/10], Loss: 0.0062
Epoch: [9/10], Loss: 0.0058
Epoch: [10/10], Loss: 0.0055
Score (accuracy) of the probe: 0.82
Training classification probe
Creating model...
Number of training instances: 908
Number of classes: 4
Epoch: [1/10], Loss: 0.0137
Epoch: [2/10], Loss: 0.0110
Epoch: [3/10], Loss: 0.0100
Epoch: [4/10], Loss: 0.0092
Epoch: [5/10], Loss: 0.0085
Epoch: [6/10], Loss: 0.0079
Epoch: [7/10], Loss: 0.0075
Epoch: [8/10], Loss: 0.0071
Epoch: [9/10], Loss: 0.0068
Epoch: [10/10], Loss: 0.0065
Score (accuracy) of the probe: 0.80
The best l1=0, the best l2=0.001 for pretrained_BERT_layer_0
Accuracy on the test set of probing pretrained_BERT_layer_0 of all layers:
Score (accuracy) of the probe: 0.70
{'__OVERALL__': 0.6997792494481236, 'NAME': 0.6625, 'STRING': 1.0, 'NUMBER': 0.9629629629629629, 'KEYWORD': 1.0}
Accuracy on the test set of pretrained_BERT_layer_0 model using the intercept:
Score (accuracy) of the probe: 0.88
pretrained_BERT_layer_0 Layer 1
Training classification probe
Creating model...
Number of training instances: 908
Number of classes: 4
Epoch: [1/10], Loss: 0.0133
Epoch: [2/10], Loss: 0.0103
Epoch: [3/10], Loss: 0.0092
Epoch: [4/10], Loss: 0.0084
Epoch: [5/10], Loss: 0.0077
Epoch: [6/10], Loss: 0.0071
Epoch: [7/10], Loss: 0.0065
Epoch: [8/10], Loss: 0.0061
Epoch: [9/10], Loss: 0.0057
Epoch: [10/10], Loss: 0.0054
Score (accuracy) of the probe: 0.70
Training classification probe
Creating model...
Number of training instances: 908
Number of classes: 4
Epoch: [1/10], Loss: 0.0128
Epoch: [2/10], Loss: 0.0101
Epoch: [3/10], Loss: 0.0090
Epoch: [4/10], Loss: 0.0081
Epoch: [5/10], Loss: 0.0074
Epoch: [6/10], Loss: 0.0068
Epoch: [7/10], Loss: 0.0063
Epoch: [8/10], Loss: 0.0059
Epoch: [9/10], Loss: 0.0055
Epoch: [10/10], Loss: 0.0052
Score (accuracy) of the probe: 0.78
Training classification probe
Creating model...
Number of training instances: 908
Number of classes: 4
Epoch: [1/10], Loss: 0.0127
Epoch: [2/10], Loss: 0.0100
Epoch: [3/10], Loss: 0.0090
Epoch: [4/10], Loss: 0.0081
Epoch: [5/10], Loss: 0.0074
Epoch: [6/10], Loss: 0.0068
Epoch: [7/10], Loss: 0.0063
Epoch: [8/10], Loss: 0.0059
Epoch: [9/10], Loss: 0.0055
Epoch: [10/10], Loss: 0.0052
Score (accuracy) of the probe: 0.82
Training classification probe
Creating model...
Number of training instances: 908
Number of classes: 4
Epoch: [1/10], Loss: 0.0137
Epoch: [2/10], Loss: 0.0110
Epoch: [3/10], Loss: 0.0100
Epoch: [4/10], Loss: 0.0091
Epoch: [5/10], Loss: 0.0085
Epoch: [6/10], Loss: 0.0079
Epoch: [7/10], Loss: 0.0075
Epoch: [8/10], Loss: 0.0071
Epoch: [9/10], Loss: 0.0067
Epoch: [10/10], Loss: 0.0064
Score (accuracy) of the probe: 0.78
The best l1=0, the best l2=0.01 for pretrained_BERT_layer_0_layer_1
Accuracy on the test set of probing pretrained_BERT_layer_0_layer_1 of all layers:
Score (accuracy) of the probe: 0.72
{'__OVERALL__': 0.7196467991169978, 'NAME': 0.6825, 'STRING': 1.0, 'NUMBER': 1.0, 'KEYWORD': 1.0}
Accuracy on the test set of pretrained_BERT_layer_0_layer_1 model using the intercept:
Score (accuracy) of the probe: 0.88
pretrained_BERT_layer_0_layer_1 Layer 2
Training classification probe
Creating model...
Number of training instances: 908
Number of classes: 4
Epoch: [1/10], Loss: 0.0134
Epoch: [2/10], Loss: 0.0105
Epoch: [3/10], Loss: 0.0093
Epoch: [4/10], Loss: 0.0084
Epoch: [5/10], Loss: 0.0077
Epoch: [6/10], Loss: 0.0071
Epoch: [7/10], Loss: 0.0066
Epoch: [8/10], Loss: 0.0061
Epoch: [9/10], Loss: 0.0058
Epoch: [10/10], Loss: 0.0054
Score (accuracy) of the probe: 0.79
Training classification probe
Creating model...
Number of training instances: 908
Number of classes: 4
Epoch: [1/10], Loss: 0.0134
Epoch: [2/10], Loss: 0.0102
Epoch: [3/10], Loss: 0.0091
Epoch: [4/10], Loss: 0.0082
Epoch: [5/10], Loss: 0.0074
Epoch: [6/10], Loss: 0.0069
Epoch: [7/10], Loss: 0.0064
Epoch: [8/10], Loss: 0.0060
Epoch: [9/10], Loss: 0.0056
Epoch: [10/10], Loss: 0.0053
Score (accuracy) of the probe: 0.77
Training classification probe
Creating model...
Number of training instances: 908
Number of classes: 4
Epoch: [1/10], Loss: 0.0129
Epoch: [2/10], Loss: 0.0101
Epoch: [3/10], Loss: 0.0091
Epoch: [4/10], Loss: 0.0082
Epoch: [5/10], Loss: 0.0075
Epoch: [6/10], Loss: 0.0069
Epoch: [7/10], Loss: 0.0064
Epoch: [8/10], Loss: 0.0060
Epoch: [9/10], Loss: 0.0057
Epoch: [10/10], Loss: 0.0053
Score (accuracy) of the probe: 0.79
Training classification probe
Creating model...
Number of training instances: 908
Number of classes: 4
Epoch: [1/10], Loss: 0.0138
Epoch: [2/10], Loss: 0.0109
Epoch: [3/10], Loss: 0.0098
Epoch: [4/10], Loss: 0.0090
Epoch: [5/10], Loss: 0.0083
Epoch: [6/10], Loss: 0.0078
Epoch: [7/10], Loss: 0.0073
Epoch: [8/10], Loss: 0.0070
Epoch: [9/10], Loss: 0.0067
Epoch: [10/10], Loss: 0.0064
Score (accuracy) of the probe: 0.80
The best l1=0, the best l2=0.1 for pretrained_BERT_layer_0_layer_1_layer_2
Accuracy on the test set of probing pretrained_BERT_layer_0_layer_1_layer_2 of all layers:
Score (accuracy) of the probe: 0.69
{'__OVERALL__': 0.6909492273730684, 'NAME': 0.6525, 'STRING': 1.0, 'NUMBER': 1.0, 'KEYWORD': 0.9545454545454546}
Accuracy on the test set of pretrained_BERT_layer_0_layer_1_layer_2 model using the intercept:
Score (accuracy) of the probe: 0.88
pretrained_BERT_layer_0_layer_1_layer_2 Layer 3
Training classification probe
Creating model...
Number of training instances: 908
Number of classes: 4
Epoch: [1/10], Loss: 0.0133
Epoch: [2/10], Loss: 0.0102
Epoch: [3/10], Loss: 0.0090
Epoch: [4/10], Loss: 0.0081
Epoch: [5/10], Loss: 0.0074
Epoch: [6/10], Loss: 0.0068
Epoch: [7/10], Loss: 0.0062
Epoch: [8/10], Loss: 0.0058
Epoch: [9/10], Loss: 0.0054
Epoch: [10/10], Loss: 0.0051
Score (accuracy) of the probe: 0.81
Training classification probe
Creating model...
Number of training instances: 908
Number of classes: 4
Epoch: [1/10], Loss: 0.0132
Epoch: [2/10], Loss: 0.0103
Epoch: [3/10], Loss: 0.0091
Epoch: [4/10], Loss: 0.0082
Epoch: [5/10], Loss: 0.0075
Epoch: [6/10], Loss: 0.0068
Epoch: [7/10], Loss: 0.0063
Epoch: [8/10], Loss: 0.0059
Epoch: [9/10], Loss: 0.0055
Epoch: [10/10], Loss: 0.0052
Score (accuracy) of the probe: 0.84
Training classification probe
Creating model...
Number of training instances: 908
Number of classes: 4
Epoch: [1/10], Loss: 0.0132
Epoch: [2/10], Loss: 0.0102
Epoch: [3/10], Loss: 0.0091
Epoch: [4/10], Loss: 0.0082
Epoch: [5/10], Loss: 0.0074
Epoch: [6/10], Loss: 0.0068
Epoch: [7/10], Loss: 0.0063
Epoch: [8/10], Loss: 0.0059
Epoch: [9/10], Loss: 0.0055
Epoch: [10/10], Loss: 0.0052
Score (accuracy) of the probe: 0.84
Training classification probe
Creating model...
Number of training instances: 908
Number of classes: 4
Epoch: [1/10], Loss: 0.0143
Epoch: [2/10], Loss: 0.0112
Epoch: [3/10], Loss: 0.0100
Epoch: [4/10], Loss: 0.0091
Epoch: [5/10], Loss: 0.0084
Epoch: [6/10], Loss: 0.0078
Epoch: [7/10], Loss: 0.0073
Epoch: [8/10], Loss: 0.0069
Epoch: [9/10], Loss: 0.0066
Epoch: [10/10], Loss: 0.0063
Score (accuracy) of the probe: 0.80
The best l1=0, the best l2=0.001 for pretrained_BERT_layer_0_layer_1_layer_2_layer_3
Accuracy on the test set of probing pretrained_BERT_layer_0_layer_1_layer_2_layer_3 of all layers:
Score (accuracy) of the probe: 0.70
{'__OVERALL__': 0.7019867549668874, 'NAME': 0.665, 'STRING': 1.0, 'NUMBER': 1.0, 'KEYWORD': 0.9545454545454546}
Accuracy on the test set of pretrained_BERT_layer_0_layer_1_layer_2_layer_3 model using the intercept:
Score (accuracy) of the probe: 0.88
pretrained_BERT_layer_0_layer_1_layer_2_layer_3 Layer 4
Training classification probe
Creating model...
Number of training instances: 908
Number of classes: 4
Epoch: [1/10], Loss: 0.0127
Epoch: [2/10], Loss: 0.0098
Epoch: [3/10], Loss: 0.0086
Epoch: [4/10], Loss: 0.0077
Epoch: [5/10], Loss: 0.0070
Epoch: [6/10], Loss: 0.0064
Epoch: [7/10], Loss: 0.0059
Epoch: [8/10], Loss: 0.0055
Epoch: [9/10], Loss: 0.0052
Epoch: [10/10], Loss: 0.0049
Score (accuracy) of the probe: 0.88
Training classification probe
Creating model...
Number of training instances: 908
Number of classes: 4
Epoch: [1/10], Loss: 0.0125
Epoch: [2/10], Loss: 0.0096
Epoch: [3/10], Loss: 0.0085
Epoch: [4/10], Loss: 0.0076
Epoch: [5/10], Loss: 0.0069
Epoch: [6/10], Loss: 0.0063
Epoch: [7/10], Loss: 0.0059
Epoch: [8/10], Loss: 0.0055
Epoch: [9/10], Loss: 0.0051
Epoch: [10/10], Loss: 0.0048
Score (accuracy) of the probe: 0.81
Training classification probe
Creating model...
Number of training instances: 908
Number of classes: 4
Epoch: [1/10], Loss: 0.0134
Epoch: [2/10], Loss: 0.0102
Epoch: [3/10], Loss: 0.0089
Epoch: [4/10], Loss: 0.0080
Epoch: [5/10], Loss: 0.0072
Epoch: [6/10], Loss: 0.0066
Epoch: [7/10], Loss: 0.0061
Epoch: [8/10], Loss: 0.0057
Epoch: [9/10], Loss: 0.0054
Epoch: [10/10], Loss: 0.0050
Score (accuracy) of the probe: 0.88
Training classification probe
Creating model...
Number of training instances: 908
Number of classes: 4
Epoch: [1/10], Loss: 0.0135
Epoch: [2/10], Loss: 0.0106
Epoch: [3/10], Loss: 0.0094
Epoch: [4/10], Loss: 0.0086
Epoch: [5/10], Loss: 0.0079
Epoch: [6/10], Loss: 0.0074
Epoch: [7/10], Loss: 0.0070
Epoch: [8/10], Loss: 0.0066
Epoch: [9/10], Loss: 0.0063
Epoch: [10/10], Loss: 0.0060
Score (accuracy) of the probe: 0.90
The best l1=0, the best l2=0.1 for pretrained_BERT_layer_0_layer_1_layer_2_layer_3_layer_4
Accuracy on the test set of probing pretrained_BERT_layer_0_layer_1_layer_2_layer_3_layer_4 of all layers:
Score (accuracy) of the probe: 0.74
{'__OVERALL__': 0.7350993377483444, 'NAME': 0.705, 'STRING': 1.0, 'NUMBER': 0.9629629629629629, 'KEYWORD': 0.9545454545454546}
Accuracy on the test set of pretrained_BERT_layer_0_layer_1_layer_2_layer_3_layer_4 model using the intercept:
Score (accuracy) of the probe: 0.88
pretrained_BERT_layer_0_layer_1_layer_2_layer_3_layer_4 Layer 5
Training classification probe
Creating model...
Number of training instances: 908
Number of classes: 4
Epoch: [1/10], Loss: 0.0127
Epoch: [2/10], Loss: 0.0098
Epoch: [3/10], Loss: 0.0086
Epoch: [4/10], Loss: 0.0077
Epoch: [5/10], Loss: 0.0070
Epoch: [6/10], Loss: 0.0064
Epoch: [7/10], Loss: 0.0059
Epoch: [8/10], Loss: 0.0055
Epoch: [9/10], Loss: 0.0051
Epoch: [10/10], Loss: 0.0048
Score (accuracy) of the probe: 0.82
Training classification probe
Creating model...
Number of training instances: 908
Number of classes: 4
Epoch: [1/10], Loss: 0.0125
Epoch: [2/10], Loss: 0.0095
Epoch: [3/10], Loss: 0.0084
Epoch: [4/10], Loss: 0.0075
Epoch: [5/10], Loss: 0.0068
Epoch: [6/10], Loss: 0.0062
Epoch: [7/10], Loss: 0.0057
Epoch: [8/10], Loss: 0.0053
Epoch: [9/10], Loss: 0.0050
Epoch: [10/10], Loss: 0.0047
Score (accuracy) of the probe: 0.91
Training classification probe
Creating model...
Number of training instances: 908
Number of classes: 4
Epoch: [1/10], Loss: 0.0129
Epoch: [2/10], Loss: 0.0099
Epoch: [3/10], Loss: 0.0087
Epoch: [4/10], Loss: 0.0078
Epoch: [5/10], Loss: 0.0070
Epoch: [6/10], Loss: 0.0064
Epoch: [7/10], Loss: 0.0059
Epoch: [8/10], Loss: 0.0055
Epoch: [9/10], Loss: 0.0052
Epoch: [10/10], Loss: 0.0049
Score (accuracy) of the probe: 0.87
Training classification probe
Creating model...
Number of training instances: 908
Number of classes: 4
Epoch: [1/10], Loss: 0.0145
Epoch: [2/10], Loss: 0.0110
Epoch: [3/10], Loss: 0.0098
Epoch: [4/10], Loss: 0.0089
Epoch: [5/10], Loss: 0.0082
Epoch: [6/10], Loss: 0.0076
Epoch: [7/10], Loss: 0.0072
Epoch: [8/10], Loss: 0.0068
Epoch: [9/10], Loss: 0.0064
Epoch: [10/10], Loss: 0.0062
Score (accuracy) of the probe: 0.88
The best l1=0, the best l2=0.001 for pretrained_BERT_layer_0_layer_1_layer_2_layer_3_layer_4_layer_5
Accuracy on the test set of probing pretrained_BERT_layer_0_layer_1_layer_2_layer_3_layer_4_layer_5 of all layers:
Score (accuracy) of the probe: 0.73
{'__OVERALL__': 0.7284768211920529, 'NAME': 0.7, 'STRING': 1.0, 'NUMBER': 0.8888888888888888, 'KEYWORD': 1.0}
Accuracy on the test set of pretrained_BERT_layer_0_layer_1_layer_2_layer_3_layer_4_layer_5 model using the intercept:
Score (accuracy) of the probe: 0.88
pretrained_BERT_layer_0_layer_1_layer_2_layer_3_layer_4_layer_5 Layer 6
Training classification probe
Creating model...
Number of training instances: 908
Number of classes: 4
Epoch: [1/10], Loss: 0.0129
Epoch: [2/10], Loss: 0.0098
Epoch: [3/10], Loss: 0.0085
Epoch: [4/10], Loss: 0.0076
Epoch: [5/10], Loss: 0.0068
Epoch: [6/10], Loss: 0.0063
Epoch: [7/10], Loss: 0.0058
Epoch: [8/10], Loss: 0.0054
Epoch: [9/10], Loss: 0.0050
Epoch: [10/10], Loss: 0.0047
Score (accuracy) of the probe: 0.89
Training classification probe
Creating model...
Number of training instances: 908
Number of classes: 4
Epoch: [1/10], Loss: 0.0128
Epoch: [2/10], Loss: 0.0098
Epoch: [3/10], Loss: 0.0085
Epoch: [4/10], Loss: 0.0076
Epoch: [5/10], Loss: 0.0069
Epoch: [6/10], Loss: 0.0064
Epoch: [7/10], Loss: 0.0059
Epoch: [8/10], Loss: 0.0055
Epoch: [9/10], Loss: 0.0051
Epoch: [10/10], Loss: 0.0048
Score (accuracy) of the probe: 0.89
Training classification probe
Creating model...
Number of training instances: 908
Number of classes: 4
Epoch: [1/10], Loss: 0.0130
Epoch: [2/10], Loss: 0.0099
Epoch: [3/10], Loss: 0.0087
Epoch: [4/10], Loss: 0.0078
Epoch: [5/10], Loss: 0.0070
Epoch: [6/10], Loss: 0.0064
Epoch: [7/10], Loss: 0.0059
Epoch: [8/10], Loss: 0.0055
Epoch: [9/10], Loss: 0.0052
Epoch: [10/10], Loss: 0.0049
Score (accuracy) of the probe: 0.89
Training classification probe
Creating model...
Number of training instances: 908
Number of classes: 4
Epoch: [1/10], Loss: 0.0138
Epoch: [2/10], Loss: 0.0107
Epoch: [3/10], Loss: 0.0094
Epoch: [4/10], Loss: 0.0085
Epoch: [5/10], Loss: 0.0078
Epoch: [6/10], Loss: 0.0073
Epoch: [7/10], Loss: 0.0069
Epoch: [8/10], Loss: 0.0065
Epoch: [9/10], Loss: 0.0062
Epoch: [10/10], Loss: 0.0060
Score (accuracy) of the probe: 0.87
The best l1=0, the best l2=0 for pretrained_BERT_layer_0_layer_1_layer_2_layer_3_layer_4_layer_5_layer_6
Accuracy on the test set of probing pretrained_BERT_layer_0_layer_1_layer_2_layer_3_layer_4_layer_5_layer_6 of all layers:
Score (accuracy) of the probe: 0.76
{'__OVERALL__': 0.7593818984547461, 'NAME': 0.73, 'STRING': 1.0, 'NUMBER': 1.0, 'KEYWORD': 0.9545454545454546}
Accuracy on the test set of pretrained_BERT_layer_0_layer_1_layer_2_layer_3_layer_4_layer_5_layer_6 model using the intercept:
Score (accuracy) of the probe: 0.88
pretrained_BERT_layer_0_layer_1_layer_2_layer_3_layer_4_layer_5_layer_6 Layer 7
Training classification probe
Creating model...
Number of training instances: 908
Number of classes: 4
Epoch: [1/10], Loss: 0.0126
Epoch: [2/10], Loss: 0.0097
Epoch: [3/10], Loss: 0.0085
Epoch: [4/10], Loss: 0.0076
Epoch: [5/10], Loss: 0.0070
Epoch: [6/10], Loss: 0.0064
Epoch: [7/10], Loss: 0.0059
Epoch: [8/10], Loss: 0.0055
Epoch: [9/10], Loss: 0.0052
Epoch: [10/10], Loss: 0.0049
Score (accuracy) of the probe: 0.88
Training classification probe
Creating model...
Number of training instances: 908
Number of classes: 4
Epoch: [1/10], Loss: 0.0132
Epoch: [2/10], Loss: 0.0098
Epoch: [3/10], Loss: 0.0086
Epoch: [4/10], Loss: 0.0077
Epoch: [5/10], Loss: 0.0070
Epoch: [6/10], Loss: 0.0064
Epoch: [7/10], Loss: 0.0059
Epoch: [8/10], Loss: 0.0055
Epoch: [9/10], Loss: 0.0052
Epoch: [10/10], Loss: 0.0049
Score (accuracy) of the probe: 0.89
Training classification probe
Creating model...
Number of training instances: 908
Number of classes: 4
Epoch: [1/10], Loss: 0.0130
Epoch: [2/10], Loss: 0.0098
Epoch: [3/10], Loss: 0.0086
Epoch: [4/10], Loss: 0.0077
Epoch: [5/10], Loss: 0.0070
Epoch: [6/10], Loss: 0.0065
Epoch: [7/10], Loss: 0.0060
Epoch: [8/10], Loss: 0.0056
Epoch: [9/10], Loss: 0.0053
Epoch: [10/10], Loss: 0.0049
Score (accuracy) of the probe: 0.90
Training classification probe
Creating model...
Number of training instances: 908
Number of classes: 4
Epoch: [1/10], Loss: 0.0133
Epoch: [2/10], Loss: 0.0104
Epoch: [3/10], Loss: 0.0093
Epoch: [4/10], Loss: 0.0085
Epoch: [5/10], Loss: 0.0079
Epoch: [6/10], Loss: 0.0074
Epoch: [7/10], Loss: 0.0070
Epoch: [8/10], Loss: 0.0066
Epoch: [9/10], Loss: 0.0063
Epoch: [10/10], Loss: 0.0061
Score (accuracy) of the probe: 0.93
The best l1=0, the best l2=0.1 for pretrained_BERT_layer_0_layer_1_layer_2_layer_3_layer_4_layer_5_layer_6_layer_7
Accuracy on the test set of probing pretrained_BERT_layer_0_layer_1_layer_2_layer_3_layer_4_layer_5_layer_6_layer_7 of all layers:
Score (accuracy) of the probe: 0.74
{'__OVERALL__': 0.7350993377483444, 'NAME': 0.7075, 'STRING': 1.0, 'NUMBER': 0.8888888888888888, 'KEYWORD': 1.0}
Accuracy on the test set of pretrained_BERT_layer_0_layer_1_layer_2_layer_3_layer_4_layer_5_layer_6_layer_7 model using the intercept:
Score (accuracy) of the probe: 0.88
pretrained_BERT_layer_0_layer_1_layer_2_layer_3_layer_4_layer_5_layer_6_layer_7 Layer 8
Training classification probe
Creating model...
Number of training instances: 908
Number of classes: 4
Epoch: [1/10], Loss: 0.0134
Epoch: [2/10], Loss: 0.0098
Epoch: [3/10], Loss: 0.0085
Epoch: [4/10], Loss: 0.0076
Epoch: [5/10], Loss: 0.0069
Epoch: [6/10], Loss: 0.0063
Epoch: [7/10], Loss: 0.0058
Epoch: [8/10], Loss: 0.0054
Epoch: [9/10], Loss: 0.0050
Epoch: [10/10], Loss: 0.0047
Score (accuracy) of the probe: 0.87
Training classification probe
Creating model...
Number of training instances: 908
Number of classes: 4
Epoch: [1/10], Loss: 0.0124
Epoch: [2/10], Loss: 0.0092
Epoch: [3/10], Loss: 0.0081
Epoch: [4/10], Loss: 0.0072
Epoch: [5/10], Loss: 0.0065
Epoch: [6/10], Loss: 0.0060
Epoch: [7/10], Loss: 0.0055
Epoch: [8/10], Loss: 0.0051
Epoch: [9/10], Loss: 0.0048
Epoch: [10/10], Loss: 0.0045
Score (accuracy) of the probe: 0.88
Training classification probe
Creating model...
Number of training instances: 908
Number of classes: 4
Epoch: [1/10], Loss: 0.0127
Epoch: [2/10], Loss: 0.0095
Epoch: [3/10], Loss: 0.0083
Epoch: [4/10], Loss: 0.0074
Epoch: [5/10], Loss: 0.0067
Epoch: [6/10], Loss: 0.0062
Epoch: [7/10], Loss: 0.0057
Epoch: [8/10], Loss: 0.0053
Epoch: [9/10], Loss: 0.0050
Epoch: [10/10], Loss: 0.0047
Score (accuracy) of the probe: 0.88
Training classification probe
Creating model...
Number of training instances: 908
Number of classes: 4
Epoch: [1/10], Loss: 0.0137
Epoch: [2/10], Loss: 0.0102
Epoch: [3/10], Loss: 0.0090
Epoch: [4/10], Loss: 0.0082
Epoch: [5/10], Loss: 0.0076
Epoch: [6/10], Loss: 0.0071
Epoch: [7/10], Loss: 0.0067
Epoch: [8/10], Loss: 0.0063
Epoch: [9/10], Loss: 0.0060
Epoch: [10/10], Loss: 0.0058
Score (accuracy) of the probe: 0.89
The best l1=0, the best l2=0.1 for pretrained_BERT_layer_0_layer_1_layer_2_layer_3_layer_4_layer_5_layer_6_layer_7_layer_8
Accuracy on the test set of probing pretrained_BERT_layer_0_layer_1_layer_2_layer_3_layer_4_layer_5_layer_6_layer_7_layer_8 of all layers:
Score (accuracy) of the probe: 0.77
{'__OVERALL__': 0.7682119205298014, 'NAME': 0.755, 'STRING': 1.0, 'NUMBER': 0.7777777777777778, 'KEYWORD': 0.9545454545454546}
Accuracy on the test set of pretrained_BERT_layer_0_layer_1_layer_2_layer_3_layer_4_layer_5_layer_6_layer_7_layer_8 model using the intercept:
Score (accuracy) of the probe: 0.88
pretrained_BERT_layer_0_layer_1_layer_2_layer_3_layer_4_layer_5_layer_6_layer_7_layer_8 Layer 9
Training classification probe
Creating model...
Number of training instances: 908
Number of classes: 4
Epoch: [1/10], Loss: 0.0134
Epoch: [2/10], Loss: 0.0097
Epoch: [3/10], Loss: 0.0084
Epoch: [4/10], Loss: 0.0074
Epoch: [5/10], Loss: 0.0065
Epoch: [6/10], Loss: 0.0059
Epoch: [7/10], Loss: 0.0054
Epoch: [8/10], Loss: 0.0050
Epoch: [9/10], Loss: 0.0046
Epoch: [10/10], Loss: 0.0043
Score (accuracy) of the probe: 0.89
Training classification probe
Creating model...
Number of training instances: 908
Number of classes: 4
Epoch: [1/10], Loss: 0.0125
Epoch: [2/10], Loss: 0.0091
Epoch: [3/10], Loss: 0.0079
Epoch: [4/10], Loss: 0.0069
Epoch: [5/10], Loss: 0.0062
Epoch: [6/10], Loss: 0.0056
Epoch: [7/10], Loss: 0.0051
Epoch: [8/10], Loss: 0.0047
Epoch: [9/10], Loss: 0.0043
Epoch: [10/10], Loss: 0.0040
Score (accuracy) of the probe: 0.89
Training classification probe
Creating model...
Number of training instances: 908
Number of classes: 4
Epoch: [1/10], Loss: 0.0132
Epoch: [2/10], Loss: 0.0096
Epoch: [3/10], Loss: 0.0083
Epoch: [4/10], Loss: 0.0073
Epoch: [5/10], Loss: 0.0065
Epoch: [6/10], Loss: 0.0059
Epoch: [7/10], Loss: 0.0054
Epoch: [8/10], Loss: 0.0050
Epoch: [9/10], Loss: 0.0047
Epoch: [10/10], Loss: 0.0043
Score (accuracy) of the probe: 0.90
Training classification probe
Creating model...
Number of training instances: 908
Number of classes: 4
Epoch: [1/10], Loss: 0.0137
Epoch: [2/10], Loss: 0.0103
Epoch: [3/10], Loss: 0.0090
Epoch: [4/10], Loss: 0.0081
Epoch: [5/10], Loss: 0.0074
Epoch: [6/10], Loss: 0.0068
Epoch: [7/10], Loss: 0.0064
Epoch: [8/10], Loss: 0.0060
Epoch: [9/10], Loss: 0.0057
Epoch: [10/10], Loss: 0.0054
Score (accuracy) of the probe: 0.90
The best l1=0, the best l2=0.01 for pretrained_BERT_layer_0_layer_1_layer_2_layer_3_layer_4_layer_5_layer_6_layer_7_layer_8_layer_9
Accuracy on the test set of probing pretrained_BERT_layer_0_layer_1_layer_2_layer_3_layer_4_layer_5_layer_6_layer_7_layer_8_layer_9 of all layers:
Score (accuracy) of the probe: 0.76
{'__OVERALL__': 0.7615894039735099, 'NAME': 0.74, 'STRING': 1.0, 'NUMBER': 0.8888888888888888, 'KEYWORD': 0.9545454545454546}
Accuracy on the test set of pretrained_BERT_layer_0_layer_1_layer_2_layer_3_layer_4_layer_5_layer_6_layer_7_layer_8_layer_9 model using the intercept:
Score (accuracy) of the probe: 0.88
pretrained_BERT_layer_0_layer_1_layer_2_layer_3_layer_4_layer_5_layer_6_layer_7_layer_8_layer_9 Layer 10
Training classification probe
Creating model...
Number of training instances: 908
Number of classes: 4
Epoch: [1/10], Loss: 0.0129
Epoch: [2/10], Loss: 0.0096
Epoch: [3/10], Loss: 0.0083
Epoch: [4/10], Loss: 0.0074
Epoch: [5/10], Loss: 0.0067
Epoch: [6/10], Loss: 0.0061
Epoch: [7/10], Loss: 0.0056
Epoch: [8/10], Loss: 0.0052
Epoch: [9/10], Loss: 0.0048
Epoch: [10/10], Loss: 0.0045
Score (accuracy) of the probe: 0.85
Training classification probe
Creating model...
Number of training instances: 908
Number of classes: 4
Epoch: [1/10], Loss: 0.0127
Epoch: [2/10], Loss: 0.0093
Epoch: [3/10], Loss: 0.0079
Epoch: [4/10], Loss: 0.0070
Epoch: [5/10], Loss: 0.0063
Epoch: [6/10], Loss: 0.0058
Epoch: [7/10], Loss: 0.0053
Epoch: [8/10], Loss: 0.0049
Epoch: [9/10], Loss: 0.0046
Epoch: [10/10], Loss: 0.0043
Score (accuracy) of the probe: 0.90
Training classification probe
Creating model...
Number of training instances: 908
Number of classes: 4
Epoch: [1/10], Loss: 0.0137
Epoch: [2/10], Loss: 0.0101
Epoch: [3/10], Loss: 0.0086
Epoch: [4/10], Loss: 0.0077
Epoch: [5/10], Loss: 0.0069
Epoch: [6/10], Loss: 0.0063
Epoch: [7/10], Loss: 0.0059
Epoch: [8/10], Loss: 0.0054
Epoch: [9/10], Loss: 0.0051
Epoch: [10/10], Loss: 0.0047
Score (accuracy) of the probe: 0.86
Training classification probe
Creating model...
Number of training instances: 908
Number of classes: 4
Epoch: [1/10], Loss: 0.0139
Epoch: [2/10], Loss: 0.0105
Epoch: [3/10], Loss: 0.0092
Epoch: [4/10], Loss: 0.0083
Epoch: [5/10], Loss: 0.0076
Epoch: [6/10], Loss: 0.0071
Epoch: [7/10], Loss: 0.0066
Epoch: [8/10], Loss: 0.0062
Epoch: [9/10], Loss: 0.0059
Epoch: [10/10], Loss: 0.0056
Score (accuracy) of the probe: 0.89
The best l1=0, the best l2=0.001 for pretrained_BERT_layer_0_layer_1_layer_2_layer_3_layer_4_layer_5_layer_6_layer_7_layer_8_layer_9_layer_10
Accuracy on the test set of probing pretrained_BERT_layer_0_layer_1_layer_2_layer_3_layer_4_layer_5_layer_6_layer_7_layer_8_layer_9_layer_10 of all layers:
Score (accuracy) of the probe: 0.78
{'__OVERALL__': 0.7770419426048565, 'NAME': 0.77, 'STRING': 1.0, 'NUMBER': 0.8148148148148148, 'KEYWORD': 0.8181818181818182}
Accuracy on the test set of pretrained_BERT_layer_0_layer_1_layer_2_layer_3_layer_4_layer_5_layer_6_layer_7_layer_8_layer_9_layer_10 model using the intercept:
Score (accuracy) of the probe: 0.88
pretrained_BERT_layer_0_layer_1_layer_2_layer_3_layer_4_layer_5_layer_6_layer_7_layer_8_layer_9_layer_10 Layer 11
Training classification probe
Creating model...
Number of training instances: 908
Number of classes: 4
Epoch: [1/10], Loss: 0.0126
Epoch: [2/10], Loss: 0.0092
Epoch: [3/10], Loss: 0.0080
Epoch: [4/10], Loss: 0.0072
Epoch: [5/10], Loss: 0.0065
Epoch: [6/10], Loss: 0.0060
Epoch: [7/10], Loss: 0.0055
Epoch: [8/10], Loss: 0.0051
Epoch: [9/10], Loss: 0.0048
Epoch: [10/10], Loss: 0.0045
Score (accuracy) of the probe: 0.87
Training classification probe
Creating model...
Number of training instances: 908
Number of classes: 4
Epoch: [1/10], Loss: 0.0135
Epoch: [2/10], Loss: 0.0097
Epoch: [3/10], Loss: 0.0083
Epoch: [4/10], Loss: 0.0074
Epoch: [5/10], Loss: 0.0067
Epoch: [6/10], Loss: 0.0062
Epoch: [7/10], Loss: 0.0057
Epoch: [8/10], Loss: 0.0053
Epoch: [9/10], Loss: 0.0050
Epoch: [10/10], Loss: 0.0046
Score (accuracy) of the probe: 0.83
Training classification probe
Creating model...
Number of training instances: 908
Number of classes: 4
Epoch: [1/10], Loss: 0.0130
Epoch: [2/10], Loss: 0.0096
Epoch: [3/10], Loss: 0.0083
Epoch: [4/10], Loss: 0.0075
Epoch: [5/10], Loss: 0.0068
Epoch: [6/10], Loss: 0.0062
Epoch: [7/10], Loss: 0.0058
Epoch: [8/10], Loss: 0.0054
Epoch: [9/10], Loss: 0.0050
Epoch: [10/10], Loss: 0.0047
Score (accuracy) of the probe: 0.87
Training classification probe
Creating model...
Number of training instances: 908
Number of classes: 4
Epoch: [1/10], Loss: 0.0140
Epoch: [2/10], Loss: 0.0106
Epoch: [3/10], Loss: 0.0092
Epoch: [4/10], Loss: 0.0083
Epoch: [5/10], Loss: 0.0076
Epoch: [6/10], Loss: 0.0071
Epoch: [7/10], Loss: 0.0067
Epoch: [8/10], Loss: 0.0063
Epoch: [9/10], Loss: 0.0060
Epoch: [10/10], Loss: 0.0057
Score (accuracy) of the probe: 0.86
The best l1=0, the best l2=0 for pretrained_BERT_layer_0_layer_1_layer_2_layer_3_layer_4_layer_5_layer_6_layer_7_layer_8_layer_9_layer_10_layer_11
Accuracy on the test set of probing pretrained_BERT_layer_0_layer_1_layer_2_layer_3_layer_4_layer_5_layer_6_layer_7_layer_8_layer_9_layer_10_layer_11 of all layers:
Score (accuracy) of the probe: 0.74
{'__OVERALL__': 0.7439293598233996, 'NAME': 0.735, 'STRING': 1.0, 'NUMBER': 0.6666666666666666, 'KEYWORD': 0.9545454545454546}
Accuracy on the test set of pretrained_BERT_layer_0_layer_1_layer_2_layer_3_layer_4_layer_5_layer_6_layer_7_layer_8_layer_9_layer_10_layer_11 model using the intercept:
Score (accuracy) of the probe: 0.88
pretrained_BERT_layer_0_layer_1_layer_2_layer_3_layer_4_layer_5_layer_6_layer_7_layer_8_layer_9_layer_10_layer_11 Layer 12
Training classification probe
Creating model...
Number of training instances: 908
Number of classes: 4
Epoch: [1/10], Loss: 0.0127
Epoch: [2/10], Loss: 0.0096
Epoch: [3/10], Loss: 0.0084
Epoch: [4/10], Loss: 0.0075
Epoch: [5/10], Loss: 0.0069
Epoch: [6/10], Loss: 0.0065
Epoch: [7/10], Loss: 0.0061
Epoch: [8/10], Loss: 0.0057
Epoch: [9/10], Loss: 0.0054
Epoch: [10/10], Loss: 0.0052
Score (accuracy) of the probe: 0.80
Training classification probe
Creating model...
Number of training instances: 908
Number of classes: 4
Epoch: [1/10], Loss: 0.0138
Epoch: [2/10], Loss: 0.0103
Epoch: [3/10], Loss: 0.0089
Epoch: [4/10], Loss: 0.0080
Epoch: [5/10], Loss: 0.0073
Epoch: [6/10], Loss: 0.0068
Epoch: [7/10], Loss: 0.0064
Epoch: [8/10], Loss: 0.0060
Epoch: [9/10], Loss: 0.0057
Epoch: [10/10], Loss: 0.0054
Score (accuracy) of the probe: 0.80
Training classification probe
Creating model...
Number of training instances: 908
Number of classes: 4
Epoch: [1/10], Loss: 0.0134
Epoch: [2/10], Loss: 0.0101
Epoch: [3/10], Loss: 0.0088
Epoch: [4/10], Loss: 0.0080
Epoch: [5/10], Loss: 0.0074
Epoch: [6/10], Loss: 0.0069
Epoch: [7/10], Loss: 0.0065
Epoch: [8/10], Loss: 0.0062
Epoch: [9/10], Loss: 0.0058
Epoch: [10/10], Loss: 0.0056
Score (accuracy) of the probe: 0.80
Training classification probe
Creating model...
Number of training instances: 908
Number of classes: 4
Epoch: [1/10], Loss: 0.0137
Epoch: [2/10], Loss: 0.0106
Epoch: [3/10], Loss: 0.0094
Epoch: [4/10], Loss: 0.0087
Epoch: [5/10], Loss: 0.0081
Epoch: [6/10], Loss: 0.0076
Epoch: [7/10], Loss: 0.0072
Epoch: [8/10], Loss: 0.0069
Epoch: [9/10], Loss: 0.0067
Epoch: [10/10], Loss: 0.0064
Score (accuracy) of the probe: 0.82
The best l1=0, the best l2=0.1 for pretrained_BERT_layer_0_layer_1_layer_2_layer_3_layer_4_layer_5_layer_6_layer_7_layer_8_layer_9_layer_10_layer_11_layer_12
Accuracy on the test set of probing pretrained_BERT_layer_0_layer_1_layer_2_layer_3_layer_4_layer_5_layer_6_layer_7_layer_8_layer_9_layer_10_layer_11_layer_12 of all layers:
Score (accuracy) of the probe: 0.71
{'__OVERALL__': 0.7064017660044151, 'NAME': 0.6825, 'STRING': 1.0, 'NUMBER': 0.8518518518518519, 'KEYWORD': 0.9090909090909091}
Accuracy on the test set of pretrained_BERT_layer_0_layer_1_layer_2_layer_3_layer_4_layer_5_layer_6_layer_7_layer_8_layer_9_layer_10_layer_11_layer_12 model using the intercept:
Score (accuracy) of the probe: 0.88
pretrained_BERT top neurons
array([   8, 8204,   12, 8208, 4113,   20, 2070, 4121, 4124,   31, 6175,
       8225, 8230,   40, 6188, 2095, 4147, 8245, 4160, 8265, 4176, 4177,
       2136, 4186, 6235, 8284,   94, 6240, 2144,  101,  106, 6250, 2154,
       2157,  112, 8317, 2173, 8331, 4237, 6305, 8357, 4262,  171,  174,
       4272, 2226, 2236,  199,  203, 4299, 4300, 8395, 2262, 4315, 4316,
        229, 4327, 8424, 6376, 6382, 8435,  246, 4343,  262, 2310, 4361,
       8459, 8462, 6423, 4380, 6433, 6434, 8488,  298,  303,  307, 6458,
       8510, 6464, 8512,  328, 6475,  333,  335, 6484,  346, 4448, 8547,
        355, 8549, 6501, 6504, 8558, 8572, 4477,  380, 8575, 4480, 6528,
       6534, 4503,  409, 4518,  425,  429, 4530,  436, 8633, 6585, 4541,
       6597, 4550,  455, 2501, 6618,  475, 2523, 2526,  478, 8673, 2531,
       6634,  490, 2541, 8687,  499, 2550, 4603, 8700, 8702, 8712, 6664,
       4619, 6672, 6675, 4629,  534, 8727, 2585, 6682,  539,  540, 8733,
       2587, 4648, 4653, 2612,  579,  586, 4683, 2643, 8793, 6748,  611,
       2659, 4714, 8812,  621, 6765, 6775, 2684, 6781, 6784,  640, 8834,
       8837, 8838,  653, 4755, 8852, 6807, 4762, 4773,  678, 2728, 8873,
        684,  690, 6843,  709, 8901, 6854, 4806, 8915,  726, 8918,  729,
       2779,  737, 8937, 8938, 8939, 2799, 8952, 6906, 4859, 2818, 6916,
        774,  776, 6923, 8976, 6930, 8979, 4892, 4897, 4898, 4900, 8999,
        808, 6952, 2864, 9013,  841, 9033, 7002, 9052, 9054, 2912, 4963,
        869,  870, 4967, 4968, 7018, 2922,  874, 7022,  880, 7024, 2935,
       9082,  891, 4988, 9088, 9090, 5001, 7052, 5005, 9111,  928, 9125,
       5030,  941, 2994, 7100, 5061,  965, 9167, 3023, 7122, 3030, 5082,
       9183, 9187, 7144, 9197, 9203, 7157, 1014, 5111, 1023, 1028, 1030,
       5129, 7181, 3087, 3089, 3096, 7195, 7196, 7197, 5148, 7208, 1066,
       1073, 9265, 1076, 1083, 5187, 9286, 3147, 1104, 7249, 7252, 1122,
       1123, 9317, 3174, 7269, 9322, 5240, 7289, 7292, 5245, 7296, 3202,
       1154, 7302, 7305, 1168, 3219, 1177, 1183, 7337, 1193, 1197, 7346,
       1204, 5318, 3275, 1235, 5334, 7382, 9448, 1258, 1267, 3317, 9463,
       7432, 1289, 5387, 5390, 7440, 3345, 7445, 1302, 3353, 1307, 3356,
       1309, 1308, 9507, 5421, 7469, 7473, 3379, 3380, 7483, 5435, 1350,
       7497, 3402, 3408, 3409, 3411, 5460, 1368, 9561, 7516, 7517, 5472,
       5482, 1386, 1389, 1401, 3449, 7549, 7551, 9602, 9605, 9606, 7559,
       7563, 1425, 5523, 3481, 1437, 7589, 1446, 3504, 9657, 9658, 7611,
       1471, 7620, 3525, 7622, 7623, 5579, 7634, 1494, 7638, 5591, 3549,
       9696, 5602, 3559, 7656, 7662, 9711, 7667, 3586, 7683, 7686, 9736,
       7691, 5643, 3602, 3606, 1591, 5690, 5691, 9788, 3643, 5696, 3650,
       3651, 7753, 3665, 3671, 3679, 3680, 7776, 7779, 1642, 3704, 5753,
       9850, 5756, 7805, 3709, 7807, 1662, 5766, 1671, 1680, 7826, 7829,
       9879, 3735, 3737, 7841, 7849, 5808, 7860, 7868, 3773, 9922, 1739,
       3791, 3799, 5850, 7905, 9955, 9971, 7927, 7934, 1798, 5896, 5904,
       7959, 7965, 7971, 3880, 3885, 3889, 1844, 1851, 3911, 1872, 5984,
       5997, 8057, 1916, 6013, 6016, 8066, 3970, 8070, 3976, 8080, 6034,
       3987, 1951, 1954, 6053, 1972, 8121, 8123, 6086, 4043, 4046, 2003,
       8150, 2007, 2014, 6125, 2036, 4091, 8188])
pretrained_BERT top neurons per class
{'NAME': array([4550, 2262,  262, 1368, 5240, 8070, 1494, 4619, 5245,  726, 7589,
       1471, 4380, 7807, 6781, 5187, 6618, 8424, 1235, 3356, 7440, 4892,
       8208, 9088, 3885, 8057, 1844, 7302, 8702, 8459, 5482, 7868, 2994,
       3030, 5997, 1437, 9090, 3559, 6784,  333,  455, 7691, 2779, 5082,
       3379, 7497, 5472, 3606, 6434, 1401, 8673, 8733,  678, 8547, 4361,
       1122,  499, 8549, 1073, 5766, 4272,  870, 1183, 7181, 6634,   40,
       3408,  346, 2684, 1954, 2036, 3680,  737, 8976, 8510, 4518, 3602,
       3219, 9879, 2643, 2864,   31, 3275, 7623, 7002, 3735, 9197, 3449,
       8915, 6923, 1642, 7196, 9971,  203, 2007, 7483, 8575, 1030, 7208,
       6034, 2818, 6423, 6086, 9183, 3773, 8873, 5696, 8245, 6305, 4160,
        709, 1083, 9696,  409,  436, 5030, 9850, 2585,  106, 8331, 5850,
       5421, 2526, 8188, 1066, 7620,  640, 3976, 8150, 4043, 8488, 8712,
       4147, 1204, 8204, 8901, 9317, 9167, 1872, 6664, 8727, 6748, 8633,
       4177, 1076, 5691, 7018, 5390,  611, 3880, 7289, 7549, 8700]), 'STRING': array([ 262, 1030, 7622,  475,  298, 9203, 4550,  539, 8208, 6672, 1368,
        106, 1307, 1642, 1425,  808,  333, 8938, 7305, 9052, 3704, 4967,
       5579,  490, 7959,  203, 9657, 9448, 7337,   31, 1122, 8673, 4683,
        579, 1258, 1916, 3799, 1798, 1680, 8123, 9265, 6781, 4124,  534,
       5187, 5904, 7807, 6305, 2226,   12, 1386, 6597, 3651, 1972,   94,
       1851, 7122, 5753, 8918, 6854, 4773, 4900, 4327, 7346, 2922, 9605,
        328, 4299, 3409, 3023, 5421, 2236,  874, 7296, 5696, 9125, 7826,
        199, 8230, 4480,  335, 3087, 3356, 4503, 7753, 4968, 8331, 8852,
        174, 4530, 8952, 5523, 7905, 1302, 2014, 7563, 7805, 4316, 7249,
       6188, 2612, 8121,  101, 7776, 6682, 1177, 3911, 6807, 7849, 8066,
       7971,  774,  586, 3380, 9788, 3549, 7549, 3481, 9286, 4113, 5318,
       7589,  409, 3586,  425,  869, 2531, 8317, 2912, 2501, 6376, 1193,
       2541, 6464, 6843, 7022, 2728, 4603, 4859, 6016, 6775, 6585, 5984,
       3174, 9013, 8572, 7683,  303, 5643, 7551, 7445, 2935, 2095, 3650,
       5602, 6528]), 'NUMBER': array([5472, 6923, 8435, 5460,  653, 7302, 2659, 6013, 6086,  737, 8459,
       1494, 2262, 7432, 3679, 1289, 1104, 3202, 7622, 9125, 8547, 7022,
       8357, 8070, 5334, 3353, 9167, 4897, 1350,  729, 8284, 8080, 1739,
       1197, 6534, 7971, 4300, 8733, 3559, 5421, 7667, 4967, 7292, 4988,
       8939, 8834, 4619,  891, 9448,  203, 7779, 7829, 6458, 9711,  229,
       3504, 9187, 1916,  880, 1951, 1030, 3680, 9736, 8687, 1309, 4714,
        478, 8837, 5690, 6250, 5904, 9203, 7860, 8558,  307, 4859, 5111,
       7197, 9054, 7100, 6781, 7683, 6382, 4653,    8, 4806, 6618, 2157,
       3525, 2799, 1154, 7965, 2136, 7469, 9602, 2154,  726, 4963, 3606,
       6125, 6501, 8230, 8937, 5523, 3481, 5318, 1183, 2550, 8150, 4629,
       6016, 7656, 6916, 9507, 3889, 1389, 3317, 7440, 7157, 3970, 8999,
       7691, 6053, 4262, 8395,  941, 7662, 3275, 2501, 5387, 4121, 7024,
       7927, 8812, 7934, 7686, 4046, 1076, 1308, 3411, 2226, 3089, 1014,
       4762, 7144, 4448, 6433, 7269, 5756, 7517,  841,  106,  355, 7516]), 'KEYWORD': array([ 262, 5245, 1368, 7432, 4237, 3885, 7589, 4477, 6952, 1028, 3987,
       8838, 8793, 6475, 7549, 5061, 9125, 6240, 6923,   20,   94, 4121,
       2612, 3737, 9090,  678,  298, 6423, 2541, 3709, 6484, 7252, 3096,
       4550, 9082, 5129, 5387, 9605, 9322, 7559, 9033, 9850, 6906, 5005,
        106, 4315, 1471, 5460, 2003, 4186,  776,  246, 9111, 4898, 1168,
        621, 7634, 6765,  928, 9463, 2310, 3402, 5472, 4343, 7195, 9955,
       6675, 5082, 3671, 2523, 9561, 1671, 1083,  425, 8057, 1123, 9736,
       7052, 3345,  475, 9922, 9197, 6618, 7382, 9606,  380, 2070, 6235,
       1446, 6775, 4541, 3147, 7841, 4091, 1662,  499, 7638,  965, 5187,
       8834, 5148, 2144, 2136, 4683, 4859, 4755,  540, 9658, 3791, 1023,
       6175, 3665, 5591, 1267,  112, 5602, 1289, 1591,  684, 3976, 6930,
       8265, 5435,  429, 8512, 5896, 4648, 8901, 8208, 8462, 8979, 2587,
       5001, 3643, 5696, 4176, 7473, 7611, 1389, 8225,  171,  690, 3549,
       9602, 2173, 2262, 7002, 5808, 6504])}
The shape of selected features (908, 491)
Training classification probe
Creating model...
Number of training instances: 908
Number of classes: 4
Epoch: [1/10], Loss: 0.0113
Epoch: [2/10], Loss: 0.0085
Epoch: [3/10], Loss: 0.0068
Epoch: [4/10], Loss: 0.0056
Epoch: [5/10], Loss: 0.0048
Epoch: [6/10], Loss: 0.0042
Epoch: [7/10], Loss: 0.0037
Epoch: [8/10], Loss: 0.0033
Epoch: [9/10], Loss: 0.0030
Epoch: [10/10], Loss: 0.0027
Score (accuracy) of the probe: 0.89
Training classification probe
Creating model...
Number of training instances: 908
Number of classes: 4
Epoch: [1/10], Loss: 0.0114
Epoch: [2/10], Loss: 0.0085
Epoch: [3/10], Loss: 0.0069
Epoch: [4/10], Loss: 0.0057
Epoch: [5/10], Loss: 0.0048
Epoch: [6/10], Loss: 0.0042
Epoch: [7/10], Loss: 0.0037
Epoch: [8/10], Loss: 0.0033
Epoch: [9/10], Loss: 0.0030
Epoch: [10/10], Loss: 0.0028
Score (accuracy) of the probe: 0.89
Training classification probe
Creating model...
Number of training instances: 908
Number of classes: 4
Epoch: [1/10], Loss: 0.0120
Epoch: [2/10], Loss: 0.0088
Epoch: [3/10], Loss: 0.0071
Epoch: [4/10], Loss: 0.0059
Epoch: [5/10], Loss: 0.0050
Epoch: [6/10], Loss: 0.0044
Epoch: [7/10], Loss: 0.0039
Epoch: [8/10], Loss: 0.0035
Epoch: [9/10], Loss: 0.0032
Epoch: [10/10], Loss: 0.0030
Score (accuracy) of the probe: 0.90
Training classification probe
Creating model...
Number of training instances: 908
Number of classes: 4
Epoch: [1/10], Loss: 0.0133
Epoch: [2/10], Loss: 0.0101
Epoch: [3/10], Loss: 0.0083
Epoch: [4/10], Loss: 0.0071
Epoch: [5/10], Loss: 0.0062
Epoch: [6/10], Loss: 0.0056
Epoch: [7/10], Loss: 0.0051
Epoch: [8/10], Loss: 0.0048
Epoch: [9/10], Loss: 0.0045
Epoch: [10/10], Loss: 0.0042
Score (accuracy) of the probe: 0.89
Accuracy on the test set of pretrained_BERT model on top 5% neurons:
Score (accuracy) of the probe: 0.78
Training classification probe
Creating model...
Number of training instances: 908
Number of classes: 4
Epoch: [1/10], Loss: 0.0124
Epoch: [2/10], Loss: 0.0108
Epoch: [3/10], Loss: 0.0096
Epoch: [4/10], Loss: 0.0086
Epoch: [5/10], Loss: 0.0078
Epoch: [6/10], Loss: 0.0072
Epoch: [7/10], Loss: 0.0066
Epoch: [8/10], Loss: 0.0061
Epoch: [9/10], Loss: 0.0057
Epoch: [10/10], Loss: 0.0054
Score (accuracy) of the probe: 0.90
Training classification probe
Creating model...
Number of training instances: 908
Number of classes: 4
Epoch: [1/10], Loss: 0.0127
Epoch: [2/10], Loss: 0.0110
Epoch: [3/10], Loss: 0.0098
Epoch: [4/10], Loss: 0.0088
Epoch: [5/10], Loss: 0.0080
Epoch: [6/10], Loss: 0.0074
Epoch: [7/10], Loss: 0.0068
Epoch: [8/10], Loss: 0.0063
Epoch: [9/10], Loss: 0.0059
Epoch: [10/10], Loss: 0.0055
Score (accuracy) of the probe: 0.84
Training classification probe
Creating model...
Number of training instances: 908
Number of classes: 4
Epoch: [1/10], Loss: 0.0118
Epoch: [2/10], Loss: 0.0103
Epoch: [3/10], Loss: 0.0091
Epoch: [4/10], Loss: 0.0082
Epoch: [5/10], Loss: 0.0074
Epoch: [6/10], Loss: 0.0068
Epoch: [7/10], Loss: 0.0063
Epoch: [8/10], Loss: 0.0059
Epoch: [9/10], Loss: 0.0055
Epoch: [10/10], Loss: 0.0052
Score (accuracy) of the probe: 0.84
Training classification probe
Creating model...
Number of training instances: 908
Number of classes: 4
Epoch: [1/10], Loss: 0.0152
Epoch: [2/10], Loss: 0.0131
Epoch: [3/10], Loss: 0.0117
Epoch: [4/10], Loss: 0.0107
Epoch: [5/10], Loss: 0.0098
Epoch: [6/10], Loss: 0.0091
Epoch: [7/10], Loss: 0.0085
Epoch: [8/10], Loss: 0.0080
Epoch: [9/10], Loss: 0.0076
Epoch: [10/10], Loss: 0.0072
Score (accuracy) of the probe: 0.82
Accuracy on the test set of pretrained_BERT model on top 200 neurons:
Score (accuracy) of the probe: 0.75
Creating control dataset for pretrained_BERT POS tagging task
Training classification probe
Creating model...
Number of training instances: 908
Number of classes: 4
Epoch: [1/10], Loss: 0.0145
Epoch: [2/10], Loss: 0.0066
Epoch: [3/10], Loss: 0.0036
Epoch: [4/10], Loss: 0.0024
Epoch: [5/10], Loss: 0.0011
Epoch: [6/10], Loss: 0.0007
Epoch: [7/10], Loss: 0.0003
Epoch: [8/10], Loss: 0.0003
Epoch: [9/10], Loss: 0.0002
Epoch: [10/10], Loss: 0.0002
Score (accuracy) of the probe: 0.98
Training classification probe
Creating model...
Number of training instances: 908
Number of classes: 4
Epoch: [1/10], Loss: 0.0143
Epoch: [2/10], Loss: 0.0059
Epoch: [3/10], Loss: 0.0034
Epoch: [4/10], Loss: 0.0023
Epoch: [5/10], Loss: 0.0010
Epoch: [6/10], Loss: 0.0006
Epoch: [7/10], Loss: 0.0003
Epoch: [8/10], Loss: 0.0003
Epoch: [9/10], Loss: 0.0002
Epoch: [10/10], Loss: 0.0002
Score (accuracy) of the probe: 0.98
Training classification probe
Creating model...
Number of training instances: 908
Number of classes: 4
Epoch: [1/10], Loss: 0.0152
Epoch: [2/10], Loss: 0.0069
Epoch: [3/10], Loss: 0.0039
Epoch: [4/10], Loss: 0.0023
Epoch: [5/10], Loss: 0.0012
Epoch: [6/10], Loss: 0.0008
Epoch: [7/10], Loss: 0.0005
Epoch: [8/10], Loss: 0.0004
Epoch: [9/10], Loss: 0.0003
Epoch: [10/10], Loss: 0.0003
Score (accuracy) of the probe: 0.98
Training classification probe
Creating model...
Number of training instances: 908
Number of classes: 4
Epoch: [1/10], Loss: 0.0154
Epoch: [2/10], Loss: 0.0076
Epoch: [3/10], Loss: 0.0049
Epoch: [4/10], Loss: 0.0038
Epoch: [5/10], Loss: 0.0025
Epoch: [6/10], Loss: 0.0021
Epoch: [7/10], Loss: 0.0018
Epoch: [8/10], Loss: 0.0017
Epoch: [9/10], Loss: 0.0016
Epoch: [10/10], Loss: 0.0016
Score (accuracy) of the probe: 0.98
The best l1=0, the best l2=0 for pretrained_BERT_control_task
Accuracy on the test set of probing pretrained_BERT_control_task of all layers:
Score (accuracy) of the probe: 0.87
{'__OVERALL__': 0.8653421633554084, 'NAME': 1.0, 'STRING': 1.0, 'NUMBER': 1.0, 'KEYWORD': 0.8475}
Accuracy on the test set of pretrained_BERT_control_task model using the intercept:
Score (accuracy) of the probe: 0.88
pretrained_BERT_control_task Selectivity (Diff. between true task and probing task performance):  -0.002207505518763808
----------------------------------------------------------------
