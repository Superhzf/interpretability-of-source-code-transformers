Getting activations from json files. If you need to extract them, run with --extract=True 

Anayzing pretrained_BERT
Loading json activations from bert_activations_train.json...
1289 13.0
Number of tokens:  1042
length of source dictionary:  1042
length of target dictionary:  34
1042
Total instances: 1042
['lightmap_tiling_offset', 'description', 'USHM_SIZE', 'set_server_powerstate', 'filter', 'in', 'SESSION_TIMEOUT', 'postinfo', 'define_profile_template', 'S_ISREG', 'required', 'profileResource', 'pooltype', 'choices', 'url', 'year', 'path', 'pdb', 'lightmap_tiling_offset_dynamic', 'RequestContext']
Number of samples:  1042
Stats: Labels with their frequencies in the final set
NAME 876
STRING 72
NUMBER 36
KEYWORD 25
COMMENT 4
NL 1
LPAR 1
DOT 1
RPAR 1
COLON 1
EQUAL 1
COMMA 1
INDENT 1
DEDENT 1
LSQB 1
RSQB 1
AT 1
STAR 1
EQEQUAL 1
MINUS 1
PLUS 1
PERCENT 1
GREATER 1
NOTEQUAL 1
PLUSEQUAL 1
GREATEREQUAL 1
LESS 1
MINEQUAL 1
LBRACE 1
RBRACE 1
LESSEQUAL 1
DOUBLESTAR 1
SLASH 1
SEMI 1
pretrained_BERT distribution:
{0: 876, 1: 72, 2: 36, 3: 25, 4: 4, 5: 1, 6: 1, 7: 1, 8: 1, 9: 1, 10: 1, 11: 1, 12: 1, 13: 1, 14: 1, 15: 1, 16: 1, 17: 1, 18: 1, 19: 1, 20: 1, 21: 1, 22: 1, 23: 1, 24: 1, 25: 1, 26: 1, 27: 1, 28: 1, 29: 1, 30: 1, 31: 1, 32: 1, 33: 1}
pretrained_BERT distribution after trauncating:
{0: 0.8681863230921705, 1: 0.07135777998017839, 2: 0.035678889990089196, 3: 0.024777006937561942}
{0: 876, 1: 72, 2: 36, 3: 25}
{'NAME': 0, 'STRING': 1, 'NUMBER': 2, 'KEYWORD': 3}
Loading json activations from bert_activations_test.json...
494 13.0
Number of tokens:  482
length of source dictionary:  482
length of target dictionary:  33
482
Total instances: 482
['x0', 'term4', 'in', 'gather_losses_and_scores', 'ValueError', 'path', 'release', 'sigmoid', 'environ', '<=', 'tanh', 'result_1', 'param', 'coeff', 'x2', 'cls', 'weight', 'crop2', '+', '3']
Number of samples:  482
Stats: Labels with their frequencies in the final set
NAME 400
NUMBER 27
KEYWORD 22
STRING 4
COMMA 1
NEWLINE 1
DOT 1
LPAR 1
RPAR 1
EQUAL 1
COLON 1
DEDENT 1
INDENT 1
LBRACE 1
RBRACE 1
LSQB 1
RSQB 1
MINUS 1
SLASH 1
AT 1
EQEQUAL 1
GREATER 1
STAREQUAL 1
LESS 1
DOUBLESTAR 1
STAR 1
PLUS 1
COMMENT 1
GREATEREQUAL 1
PLUSEQUAL 1
LESSEQUAL 1
PERCENT 1
AMPER 1
pretrained_BERT distribution:
{0: 400, 1: 27, 2: 22, 3: 4, 4: 1, 5: 1, 6: 1, 7: 1, 8: 1, 9: 1, 10: 1, 11: 1, 12: 1, 13: 1, 14: 1, 15: 1, 16: 1, 17: 1, 18: 1, 19: 1, 20: 1, 21: 1, 22: 1, 23: 1, 24: 1, 25: 1, 26: 1, 27: 1, 28: 1, 29: 1, 30: 1, 31: 1, 32: 1}
pretrained_BERT distribution after trauncating:
{0: 0.8830022075055187, 1: 0.059602649006622516, 2: 0.04856512141280353, 3: 0.008830022075055188}
{0: 400, 1: 27, 2: 22, 3: 4}
{'NAME': 0, 'NUMBER': 1, 'KEYWORD': 2, 'STRING': 3}
The shape of the training set: (842, 9984)
The shape of the validation set: (94, 9984)
The shape of the testing set: (453, 9984)
Training classification probe
Creating model...
Number of training instances: 842
Number of classes: 4
Epoch: [1/10], Loss: 0.0199
Epoch: [2/10], Loss: 0.0076
Epoch: [3/10], Loss: 0.0056
Epoch: [4/10], Loss: 0.0033
Epoch: [5/10], Loss: 0.0017
Epoch: [6/10], Loss: 0.0012
Epoch: [7/10], Loss: 0.0007
Epoch: [8/10], Loss: 0.0005
Epoch: [9/10], Loss: 0.0004
Epoch: [10/10], Loss: 0.0003
Score (accuracy) of the probe: 0.96
Training classification probe
Creating model...
Number of training instances: 842
Number of classes: 4
Epoch: [1/10], Loss: 0.0194
Epoch: [2/10], Loss: 0.0077
Epoch: [3/10], Loss: 0.0055
Epoch: [4/10], Loss: 0.0037
Epoch: [5/10], Loss: 0.0018
Epoch: [6/10], Loss: 0.0012
Epoch: [7/10], Loss: 0.0007
Epoch: [8/10], Loss: 0.0005
Epoch: [9/10], Loss: 0.0004
Epoch: [10/10], Loss: 0.0003
Score (accuracy) of the probe: 0.99
Training classification probe
Creating model...
Number of training instances: 842
Number of classes: 4
Epoch: [1/10], Loss: 0.0191
Epoch: [2/10], Loss: 0.0078
Epoch: [3/10], Loss: 0.0058
Epoch: [4/10], Loss: 0.0037
Epoch: [5/10], Loss: 0.0019
Epoch: [6/10], Loss: 0.0012
Epoch: [7/10], Loss: 0.0008
Epoch: [8/10], Loss: 0.0006
Epoch: [9/10], Loss: 0.0005
Epoch: [10/10], Loss: 0.0005
Score (accuracy) of the probe: 0.99
Training classification probe
Creating model...
Number of training instances: 842
Number of classes: 4
Epoch: [1/10], Loss: 0.0204
Epoch: [2/10], Loss: 0.0084
Epoch: [3/10], Loss: 0.0069
Epoch: [4/10], Loss: 0.0044
Epoch: [5/10], Loss: 0.0029
Epoch: [6/10], Loss: 0.0024
Epoch: [7/10], Loss: 0.0020
Epoch: [8/10], Loss: 0.0018
Epoch: [9/10], Loss: 0.0017
Epoch: [10/10], Loss: 0.0016
Score (accuracy) of the probe: 0.97
The best l1=0, the best l2=0.001 for pretrained_BERT
Accuracy on the test set of probing pretrained_BERT of all layers:
Score (accuracy) of the probe: 0.82
{'__OVERALL__': 0.8233995584988962, 'NAME': 0.8275, 'STRING': 1.0, 'NUMBER': 1.0, 'KEYWORD': 0.5}
Accuracy on the test set of pretrained_BERT model using the intercept:
Score (accuracy) of the probe: 0.88
pretrained_BERT Layer 0
Training classification probe
Creating model...
Number of training instances: 842
Number of classes: 4
Epoch: [1/10], Loss: 0.0122
Epoch: [2/10], Loss: 0.0104
Epoch: [3/10], Loss: 0.0095
Epoch: [4/10], Loss: 0.0088
Epoch: [5/10], Loss: 0.0082
Epoch: [6/10], Loss: 0.0077
Epoch: [7/10], Loss: 0.0072
Epoch: [8/10], Loss: 0.0068
Epoch: [9/10], Loss: 0.0064
Epoch: [10/10], Loss: 0.0060
Score (accuracy) of the probe: 0.79
Training classification probe
Creating model...
Number of training instances: 842
Number of classes: 4
Epoch: [1/10], Loss: 0.0127
Epoch: [2/10], Loss: 0.0107
Epoch: [3/10], Loss: 0.0097
Epoch: [4/10], Loss: 0.0090
Epoch: [5/10], Loss: 0.0084
Epoch: [6/10], Loss: 0.0079
Epoch: [7/10], Loss: 0.0074
Epoch: [8/10], Loss: 0.0070
Epoch: [9/10], Loss: 0.0066
Epoch: [10/10], Loss: 0.0062
Score (accuracy) of the probe: 0.77
Training classification probe
Creating model...
Number of training instances: 842
Number of classes: 4
Epoch: [1/10], Loss: 0.0130
Epoch: [2/10], Loss: 0.0109
Epoch: [3/10], Loss: 0.0099
Epoch: [4/10], Loss: 0.0091
Epoch: [5/10], Loss: 0.0085
Epoch: [6/10], Loss: 0.0079
Epoch: [7/10], Loss: 0.0075
Epoch: [8/10], Loss: 0.0070
Epoch: [9/10], Loss: 0.0067
Epoch: [10/10], Loss: 0.0063
Score (accuracy) of the probe: 0.76
Training classification probe
Creating model...
Number of training instances: 842
Number of classes: 4
Epoch: [1/10], Loss: 0.0135
Epoch: [2/10], Loss: 0.0116
Epoch: [3/10], Loss: 0.0107
Epoch: [4/10], Loss: 0.0100
Epoch: [5/10], Loss: 0.0094
Epoch: [6/10], Loss: 0.0089
Epoch: [7/10], Loss: 0.0084
Epoch: [8/10], Loss: 0.0080
Epoch: [9/10], Loss: 0.0077
Epoch: [10/10], Loss: 0.0073
Score (accuracy) of the probe: 0.77
The best l1=0, the best l2=0 for pretrained_BERT_layer_0
Accuracy on the test set of probing pretrained_BERT_layer_0 of all layers:
Score (accuracy) of the probe: 0.63
{'__OVERALL__': 0.6269315673289183, 'NAME': 0.635, 'STRING': 1.0, 'NUMBER': 0.6296296296296297, 'KEYWORD': 0.4090909090909091}
Accuracy on the test set of pretrained_BERT_layer_0 model using the intercept:
Score (accuracy) of the probe: 0.88
pretrained_BERT Layer 1
Training classification probe
Creating model...
Number of training instances: 842
Number of classes: 4
Epoch: [1/10], Loss: 0.0122
Epoch: [2/10], Loss: 0.0103
Epoch: [3/10], Loss: 0.0094
Epoch: [4/10], Loss: 0.0087
Epoch: [5/10], Loss: 0.0081
Epoch: [6/10], Loss: 0.0075
Epoch: [7/10], Loss: 0.0071
Epoch: [8/10], Loss: 0.0067
Epoch: [9/10], Loss: 0.0063
Epoch: [10/10], Loss: 0.0060
Score (accuracy) of the probe: 0.81
Training classification probe
Creating model...
Number of training instances: 842
Number of classes: 4
Epoch: [1/10], Loss: 0.0126
Epoch: [2/10], Loss: 0.0107
Epoch: [3/10], Loss: 0.0097
Epoch: [4/10], Loss: 0.0090
Epoch: [5/10], Loss: 0.0084
Epoch: [6/10], Loss: 0.0078
Epoch: [7/10], Loss: 0.0074
Epoch: [8/10], Loss: 0.0069
Epoch: [9/10], Loss: 0.0066
Epoch: [10/10], Loss: 0.0062
Score (accuracy) of the probe: 0.72
Training classification probe
Creating model...
Number of training instances: 842
Number of classes: 4
Epoch: [1/10], Loss: 0.0125
Epoch: [2/10], Loss: 0.0106
Epoch: [3/10], Loss: 0.0097
Epoch: [4/10], Loss: 0.0090
Epoch: [5/10], Loss: 0.0084
Epoch: [6/10], Loss: 0.0079
Epoch: [7/10], Loss: 0.0074
Epoch: [8/10], Loss: 0.0070
Epoch: [9/10], Loss: 0.0066
Epoch: [10/10], Loss: 0.0063
Score (accuracy) of the probe: 0.81
Training classification probe
Creating model...
Number of training instances: 842
Number of classes: 4
Epoch: [1/10], Loss: 0.0139
Epoch: [2/10], Loss: 0.0118
Epoch: [3/10], Loss: 0.0108
Epoch: [4/10], Loss: 0.0101
Epoch: [5/10], Loss: 0.0095
Epoch: [6/10], Loss: 0.0090
Epoch: [7/10], Loss: 0.0085
Epoch: [8/10], Loss: 0.0081
Epoch: [9/10], Loss: 0.0078
Epoch: [10/10], Loss: 0.0074
Score (accuracy) of the probe: 0.74
The best l1=0, the best l2=0 for pretrained_BERT_layer_1
Accuracy on the test set of probing pretrained_BERT_layer_1 of all layers:
Score (accuracy) of the probe: 0.64
{'__OVERALL__': 0.6357615894039735, 'NAME': 0.6225, 'STRING': 1.0, 'NUMBER': 1.0, 'KEYWORD': 0.36363636363636365}
Accuracy on the test set of pretrained_BERT_layer_1 model using the intercept:
Score (accuracy) of the probe: 0.88
pretrained_BERT Layer 2
Training classification probe
Creating model...
Number of training instances: 842
Number of classes: 4
Epoch: [1/10], Loss: 0.0128
Epoch: [2/10], Loss: 0.0108
Epoch: [3/10], Loss: 0.0098
Epoch: [4/10], Loss: 0.0091
Epoch: [5/10], Loss: 0.0085
Epoch: [6/10], Loss: 0.0080
Epoch: [7/10], Loss: 0.0075
Epoch: [8/10], Loss: 0.0071
Epoch: [9/10], Loss: 0.0067
Epoch: [10/10], Loss: 0.0064
Score (accuracy) of the probe: 0.74
Training classification probe
Creating model...
Number of training instances: 842
Number of classes: 4
Epoch: [1/10], Loss: 0.0128
Epoch: [2/10], Loss: 0.0108
Epoch: [3/10], Loss: 0.0098
Epoch: [4/10], Loss: 0.0091
Epoch: [5/10], Loss: 0.0085
Epoch: [6/10], Loss: 0.0079
Epoch: [7/10], Loss: 0.0075
Epoch: [8/10], Loss: 0.0070
Epoch: [9/10], Loss: 0.0067
Epoch: [10/10], Loss: 0.0063
Score (accuracy) of the probe: 0.72
Training classification probe
Creating model...
Number of training instances: 842
Number of classes: 4
Epoch: [1/10], Loss: 0.0128
Epoch: [2/10], Loss: 0.0108
Epoch: [3/10], Loss: 0.0098
Epoch: [4/10], Loss: 0.0091
Epoch: [5/10], Loss: 0.0085
Epoch: [6/10], Loss: 0.0080
Epoch: [7/10], Loss: 0.0076
Epoch: [8/10], Loss: 0.0072
Epoch: [9/10], Loss: 0.0068
Epoch: [10/10], Loss: 0.0065
Score (accuracy) of the probe: 0.66
Training classification probe
Creating model...
Number of training instances: 842
Number of classes: 4
Epoch: [1/10], Loss: 0.0136
Epoch: [2/10], Loss: 0.0116
Epoch: [3/10], Loss: 0.0106
Epoch: [4/10], Loss: 0.0099
Epoch: [5/10], Loss: 0.0093
Epoch: [6/10], Loss: 0.0087
Epoch: [7/10], Loss: 0.0083
Epoch: [8/10], Loss: 0.0079
Epoch: [9/10], Loss: 0.0076
Epoch: [10/10], Loss: 0.0073
Score (accuracy) of the probe: 0.73
The best l1=0, the best l2=0 for pretrained_BERT_layer_2
Accuracy on the test set of probing pretrained_BERT_layer_2 of all layers:
Score (accuracy) of the probe: 0.63
{'__OVERALL__': 0.6291390728476821, 'NAME': 0.615, 'STRING': 1.0, 'NUMBER': 0.9629629629629629, 'KEYWORD': 0.4090909090909091}
Accuracy on the test set of pretrained_BERT_layer_2 model using the intercept:
Score (accuracy) of the probe: 0.88
pretrained_BERT Layer 3
Training classification probe
Creating model...
Number of training instances: 842
Number of classes: 4
Epoch: [1/10], Loss: 0.0125
Epoch: [2/10], Loss: 0.0105
Epoch: [3/10], Loss: 0.0095
Epoch: [4/10], Loss: 0.0088
Epoch: [5/10], Loss: 0.0082
Epoch: [6/10], Loss: 0.0077
Epoch: [7/10], Loss: 0.0072
Epoch: [8/10], Loss: 0.0068
Epoch: [9/10], Loss: 0.0064
Epoch: [10/10], Loss: 0.0061
Score (accuracy) of the probe: 0.79
Training classification probe
Creating model...
Number of training instances: 842
Number of classes: 4
Epoch: [1/10], Loss: 0.0132
Epoch: [2/10], Loss: 0.0110
Epoch: [3/10], Loss: 0.0100
Epoch: [4/10], Loss: 0.0092
Epoch: [5/10], Loss: 0.0086
Epoch: [6/10], Loss: 0.0080
Epoch: [7/10], Loss: 0.0075
Epoch: [8/10], Loss: 0.0071
Epoch: [9/10], Loss: 0.0067
Epoch: [10/10], Loss: 0.0064
Score (accuracy) of the probe: 0.69
Training classification probe
Creating model...
Number of training instances: 842
Number of classes: 4
Epoch: [1/10], Loss: 0.0123
Epoch: [2/10], Loss: 0.0104
Epoch: [3/10], Loss: 0.0094
Epoch: [4/10], Loss: 0.0087
Epoch: [5/10], Loss: 0.0081
Epoch: [6/10], Loss: 0.0076
Epoch: [7/10], Loss: 0.0071
Epoch: [8/10], Loss: 0.0067
Epoch: [9/10], Loss: 0.0064
Epoch: [10/10], Loss: 0.0061
Score (accuracy) of the probe: 0.81
Training classification probe
Creating model...
Number of training instances: 842
Number of classes: 4
Epoch: [1/10], Loss: 0.0136
Epoch: [2/10], Loss: 0.0114
Epoch: [3/10], Loss: 0.0104
Epoch: [4/10], Loss: 0.0097
Epoch: [5/10], Loss: 0.0091
Epoch: [6/10], Loss: 0.0086
Epoch: [7/10], Loss: 0.0081
Epoch: [8/10], Loss: 0.0078
Epoch: [9/10], Loss: 0.0074
Epoch: [10/10], Loss: 0.0071
Score (accuracy) of the probe: 0.76
The best l1=0, the best l2=0.01 for pretrained_BERT_layer_3
Accuracy on the test set of probing pretrained_BERT_layer_3 of all layers:
Score (accuracy) of the probe: 0.66
{'__OVERALL__': 0.6578366445916115, 'NAME': 0.6475, 'STRING': 1.0, 'NUMBER': 0.9629629629629629, 'KEYWORD': 0.4090909090909091}
Accuracy on the test set of pretrained_BERT_layer_3 model using the intercept:
Score (accuracy) of the probe: 0.88
pretrained_BERT Layer 4
Training classification probe
Creating model...
Number of training instances: 842
Number of classes: 4
Epoch: [1/10], Loss: 0.0125
Epoch: [2/10], Loss: 0.0104
Epoch: [3/10], Loss: 0.0093
Epoch: [4/10], Loss: 0.0086
Epoch: [5/10], Loss: 0.0079
Epoch: [6/10], Loss: 0.0074
Epoch: [7/10], Loss: 0.0069
Epoch: [8/10], Loss: 0.0065
Epoch: [9/10], Loss: 0.0062
Epoch: [10/10], Loss: 0.0058
Score (accuracy) of the probe: 0.85
Training classification probe
Creating model...
Number of training instances: 842
Number of classes: 4
Epoch: [1/10], Loss: 0.0127
Epoch: [2/10], Loss: 0.0106
Epoch: [3/10], Loss: 0.0095
Epoch: [4/10], Loss: 0.0088
Epoch: [5/10], Loss: 0.0081
Epoch: [6/10], Loss: 0.0076
Epoch: [7/10], Loss: 0.0071
Epoch: [8/10], Loss: 0.0067
Epoch: [9/10], Loss: 0.0063
Epoch: [10/10], Loss: 0.0060
Score (accuracy) of the probe: 0.85
Training classification probe
Creating model...
Number of training instances: 842
Number of classes: 4
Epoch: [1/10], Loss: 0.0127
Epoch: [2/10], Loss: 0.0106
Epoch: [3/10], Loss: 0.0096
Epoch: [4/10], Loss: 0.0089
Epoch: [5/10], Loss: 0.0082
Epoch: [6/10], Loss: 0.0077
Epoch: [7/10], Loss: 0.0072
Epoch: [8/10], Loss: 0.0068
Epoch: [9/10], Loss: 0.0064
Epoch: [10/10], Loss: 0.0061
Score (accuracy) of the probe: 0.82
Training classification probe
Creating model...
Number of training instances: 842
Number of classes: 4
Epoch: [1/10], Loss: 0.0136
Epoch: [2/10], Loss: 0.0114
Epoch: [3/10], Loss: 0.0103
Epoch: [4/10], Loss: 0.0096
Epoch: [5/10], Loss: 0.0090
Epoch: [6/10], Loss: 0.0084
Epoch: [7/10], Loss: 0.0080
Epoch: [8/10], Loss: 0.0076
Epoch: [9/10], Loss: 0.0072
Epoch: [10/10], Loss: 0.0069
Score (accuracy) of the probe: 0.85
The best l1=0, the best l2=0 for pretrained_BERT_layer_4
Accuracy on the test set of probing pretrained_BERT_layer_4 of all layers:
Score (accuracy) of the probe: 0.61
{'__OVERALL__': 0.6070640176600441, 'NAME': 0.59, 'STRING': 1.0, 'NUMBER': 0.9259259259259259, 'KEYWORD': 0.45454545454545453}
Accuracy on the test set of pretrained_BERT_layer_4 model using the intercept:
Score (accuracy) of the probe: 0.88
pretrained_BERT Layer 5
Training classification probe
Creating model...
Number of training instances: 842
Number of classes: 4
Epoch: [1/10], Loss: 0.0129
Epoch: [2/10], Loss: 0.0106
Epoch: [3/10], Loss: 0.0095
Epoch: [4/10], Loss: 0.0088
Epoch: [5/10], Loss: 0.0081
Epoch: [6/10], Loss: 0.0075
Epoch: [7/10], Loss: 0.0071
Epoch: [8/10], Loss: 0.0066
Epoch: [9/10], Loss: 0.0063
Epoch: [10/10], Loss: 0.0059
Score (accuracy) of the probe: 0.81
Training classification probe
Creating model...
Number of training instances: 842
Number of classes: 4
Epoch: [1/10], Loss: 0.0130
Epoch: [2/10], Loss: 0.0106
Epoch: [3/10], Loss: 0.0095
Epoch: [4/10], Loss: 0.0087
Epoch: [5/10], Loss: 0.0081
Epoch: [6/10], Loss: 0.0075
Epoch: [7/10], Loss: 0.0071
Epoch: [8/10], Loss: 0.0066
Epoch: [9/10], Loss: 0.0063
Epoch: [10/10], Loss: 0.0059
Score (accuracy) of the probe: 0.85
Training classification probe
Creating model...
Number of training instances: 842
Number of classes: 4
Epoch: [1/10], Loss: 0.0133
Epoch: [2/10], Loss: 0.0110
Epoch: [3/10], Loss: 0.0099
Epoch: [4/10], Loss: 0.0091
Epoch: [5/10], Loss: 0.0084
Epoch: [6/10], Loss: 0.0079
Epoch: [7/10], Loss: 0.0074
Epoch: [8/10], Loss: 0.0070
Epoch: [9/10], Loss: 0.0066
Epoch: [10/10], Loss: 0.0062
Score (accuracy) of the probe: 0.81
Training classification probe
Creating model...
Number of training instances: 842
Number of classes: 4
Epoch: [1/10], Loss: 0.0134
Epoch: [2/10], Loss: 0.0113
Epoch: [3/10], Loss: 0.0103
Epoch: [4/10], Loss: 0.0096
Epoch: [5/10], Loss: 0.0089
Epoch: [6/10], Loss: 0.0084
Epoch: [7/10], Loss: 0.0080
Epoch: [8/10], Loss: 0.0076
Epoch: [9/10], Loss: 0.0072
Epoch: [10/10], Loss: 0.0069
Score (accuracy) of the probe: 0.80
The best l1=0, the best l2=0.001 for pretrained_BERT_layer_5
Accuracy on the test set of probing pretrained_BERT_layer_5 of all layers:
Score (accuracy) of the probe: 0.63
{'__OVERALL__': 0.6291390728476821, 'NAME': 0.635, 'STRING': 1.0, 'NUMBER': 0.7777777777777778, 'KEYWORD': 0.2727272727272727}
Accuracy on the test set of pretrained_BERT_layer_5 model using the intercept:
Score (accuracy) of the probe: 0.88
pretrained_BERT Layer 6
Training classification probe
Creating model...
Number of training instances: 842
Number of classes: 4
Epoch: [1/10], Loss: 0.0122
Epoch: [2/10], Loss: 0.0103
Epoch: [3/10], Loss: 0.0093
Epoch: [4/10], Loss: 0.0085
Epoch: [5/10], Loss: 0.0079
Epoch: [6/10], Loss: 0.0074
Epoch: [7/10], Loss: 0.0069
Epoch: [8/10], Loss: 0.0065
Epoch: [9/10], Loss: 0.0061
Epoch: [10/10], Loss: 0.0058
Score (accuracy) of the probe: 0.85
Training classification probe
Creating model...
Number of training instances: 842
Number of classes: 4
Epoch: [1/10], Loss: 0.0132
Epoch: [2/10], Loss: 0.0110
Epoch: [3/10], Loss: 0.0099
Epoch: [4/10], Loss: 0.0091
Epoch: [5/10], Loss: 0.0085
Epoch: [6/10], Loss: 0.0079
Epoch: [7/10], Loss: 0.0074
Epoch: [8/10], Loss: 0.0070
Epoch: [9/10], Loss: 0.0066
Epoch: [10/10], Loss: 0.0062
Score (accuracy) of the probe: 0.83
Training classification probe
Creating model...
Number of training instances: 842
Number of classes: 4
Epoch: [1/10], Loss: 0.0131
Epoch: [2/10], Loss: 0.0109
Epoch: [3/10], Loss: 0.0098
Epoch: [4/10], Loss: 0.0090
Epoch: [5/10], Loss: 0.0083
Epoch: [6/10], Loss: 0.0078
Epoch: [7/10], Loss: 0.0073
Epoch: [8/10], Loss: 0.0069
Epoch: [9/10], Loss: 0.0065
Epoch: [10/10], Loss: 0.0062
Score (accuracy) of the probe: 0.82
Training classification probe
Creating model...
Number of training instances: 842
Number of classes: 4
Epoch: [1/10], Loss: 0.0131
Epoch: [2/10], Loss: 0.0111
Epoch: [3/10], Loss: 0.0101
Epoch: [4/10], Loss: 0.0093
Epoch: [5/10], Loss: 0.0087
Epoch: [6/10], Loss: 0.0082
Epoch: [7/10], Loss: 0.0078
Epoch: [8/10], Loss: 0.0074
Epoch: [9/10], Loss: 0.0071
Epoch: [10/10], Loss: 0.0068
Score (accuracy) of the probe: 0.83
The best l1=0, the best l2=0 for pretrained_BERT_layer_6
Accuracy on the test set of probing pretrained_BERT_layer_6 of all layers:
Score (accuracy) of the probe: 0.62
{'__OVERALL__': 0.6225165562913907, 'NAME': 0.66, 'STRING': 1.0, 'NUMBER': 0.37037037037037035, 'KEYWORD': 0.18181818181818182}
Accuracy on the test set of pretrained_BERT_layer_6 model using the intercept:
Score (accuracy) of the probe: 0.88
pretrained_BERT Layer 7
Training classification probe
Creating model...
Number of training instances: 842
Number of classes: 4
Epoch: [1/10], Loss: 0.0127
Epoch: [2/10], Loss: 0.0105
Epoch: [3/10], Loss: 0.0094
Epoch: [4/10], Loss: 0.0086
Epoch: [5/10], Loss: 0.0080
Epoch: [6/10], Loss: 0.0075
Epoch: [7/10], Loss: 0.0070
Epoch: [8/10], Loss: 0.0066
Epoch: [9/10], Loss: 0.0062
Epoch: [10/10], Loss: 0.0059
Score (accuracy) of the probe: 0.87
Training classification probe
Creating model...
Number of training instances: 842
Number of classes: 4
Epoch: [1/10], Loss: 0.0122
Epoch: [2/10], Loss: 0.0102
Epoch: [3/10], Loss: 0.0092
Epoch: [4/10], Loss: 0.0085
Epoch: [5/10], Loss: 0.0078
Epoch: [6/10], Loss: 0.0073
Epoch: [7/10], Loss: 0.0069
Epoch: [8/10], Loss: 0.0064
Epoch: [9/10], Loss: 0.0061
Epoch: [10/10], Loss: 0.0058
Score (accuracy) of the probe: 0.86
Training classification probe
Creating model...
Number of training instances: 842
Number of classes: 4
Epoch: [1/10], Loss: 0.0122
Epoch: [2/10], Loss: 0.0101
Epoch: [3/10], Loss: 0.0092
Epoch: [4/10], Loss: 0.0085
Epoch: [5/10], Loss: 0.0079
Epoch: [6/10], Loss: 0.0074
Epoch: [7/10], Loss: 0.0069
Epoch: [8/10], Loss: 0.0065
Epoch: [9/10], Loss: 0.0062
Epoch: [10/10], Loss: 0.0059
Score (accuracy) of the probe: 0.85
Training classification probe
Creating model...
Number of training instances: 842
Number of classes: 4
Epoch: [1/10], Loss: 0.0133
Epoch: [2/10], Loss: 0.0111
Epoch: [3/10], Loss: 0.0101
Epoch: [4/10], Loss: 0.0094
Epoch: [5/10], Loss: 0.0088
Epoch: [6/10], Loss: 0.0083
Epoch: [7/10], Loss: 0.0079
Epoch: [8/10], Loss: 0.0075
Epoch: [9/10], Loss: 0.0072
Epoch: [10/10], Loss: 0.0069
Score (accuracy) of the probe: 0.89
The best l1=0, the best l2=0.1 for pretrained_BERT_layer_7
Accuracy on the test set of probing pretrained_BERT_layer_7 of all layers:
Score (accuracy) of the probe: 0.65
{'__OVERALL__': 0.6512141280353201, 'NAME': 0.6725, 'STRING': 1.0, 'NUMBER': 0.6666666666666666, 'KEYWORD': 0.18181818181818182}
Accuracy on the test set of pretrained_BERT_layer_7 model using the intercept:
Score (accuracy) of the probe: 0.88
pretrained_BERT Layer 8
Training classification probe
Creating model...
Number of training instances: 842
Number of classes: 4
Epoch: [1/10], Loss: 0.0128
Epoch: [2/10], Loss: 0.0106
Epoch: [3/10], Loss: 0.0096
Epoch: [4/10], Loss: 0.0087
Epoch: [5/10], Loss: 0.0081
Epoch: [6/10], Loss: 0.0075
Epoch: [7/10], Loss: 0.0070
Epoch: [8/10], Loss: 0.0065
Epoch: [9/10], Loss: 0.0061
Epoch: [10/10], Loss: 0.0058
Score (accuracy) of the probe: 0.90
Training classification probe
Creating model...
Number of training instances: 842
Number of classes: 4
Epoch: [1/10], Loss: 0.0124
Epoch: [2/10], Loss: 0.0102
Epoch: [3/10], Loss: 0.0092
Epoch: [4/10], Loss: 0.0084
Epoch: [5/10], Loss: 0.0078
Epoch: [6/10], Loss: 0.0073
Epoch: [7/10], Loss: 0.0068
Epoch: [8/10], Loss: 0.0064
Epoch: [9/10], Loss: 0.0060
Epoch: [10/10], Loss: 0.0056
Score (accuracy) of the probe: 0.88
Training classification probe
Creating model...
Number of training instances: 842
Number of classes: 4
Epoch: [1/10], Loss: 0.0124
Epoch: [2/10], Loss: 0.0102
Epoch: [3/10], Loss: 0.0092
Epoch: [4/10], Loss: 0.0084
Epoch: [5/10], Loss: 0.0078
Epoch: [6/10], Loss: 0.0072
Epoch: [7/10], Loss: 0.0068
Epoch: [8/10], Loss: 0.0064
Epoch: [9/10], Loss: 0.0060
Epoch: [10/10], Loss: 0.0057
Score (accuracy) of the probe: 0.83
Training classification probe
Creating model...
Number of training instances: 842
Number of classes: 4
Epoch: [1/10], Loss: 0.0132
Epoch: [2/10], Loss: 0.0110
Epoch: [3/10], Loss: 0.0100
Epoch: [4/10], Loss: 0.0093
Epoch: [5/10], Loss: 0.0086
Epoch: [6/10], Loss: 0.0081
Epoch: [7/10], Loss: 0.0077
Epoch: [8/10], Loss: 0.0073
Epoch: [9/10], Loss: 0.0069
Epoch: [10/10], Loss: 0.0066
Score (accuracy) of the probe: 0.82
The best l1=0, the best l2=0 for pretrained_BERT_layer_8
Accuracy on the test set of probing pretrained_BERT_layer_8 of all layers:
Score (accuracy) of the probe: 0.66
{'__OVERALL__': 0.6622516556291391, 'NAME': 0.6875, 'STRING': 1.0, 'NUMBER': 0.5185185185185185, 'KEYWORD': 0.3181818181818182}
Accuracy on the test set of pretrained_BERT_layer_8 model using the intercept:
Score (accuracy) of the probe: 0.88
pretrained_BERT Layer 9
Training classification probe
Creating model...
Number of training instances: 842
Number of classes: 4
Epoch: [1/10], Loss: 0.0124
Epoch: [2/10], Loss: 0.0100
Epoch: [3/10], Loss: 0.0088
Epoch: [4/10], Loss: 0.0080
Epoch: [5/10], Loss: 0.0074
Epoch: [6/10], Loss: 0.0068
Epoch: [7/10], Loss: 0.0063
Epoch: [8/10], Loss: 0.0059
Epoch: [9/10], Loss: 0.0055
Epoch: [10/10], Loss: 0.0052
Score (accuracy) of the probe: 0.88
Training classification probe
Creating model...
Number of training instances: 842
Number of classes: 4
Epoch: [1/10], Loss: 0.0127
Epoch: [2/10], Loss: 0.0102
Epoch: [3/10], Loss: 0.0090
Epoch: [4/10], Loss: 0.0082
Epoch: [5/10], Loss: 0.0076
Epoch: [6/10], Loss: 0.0070
Epoch: [7/10], Loss: 0.0065
Epoch: [8/10], Loss: 0.0060
Epoch: [9/10], Loss: 0.0056
Epoch: [10/10], Loss: 0.0053
Score (accuracy) of the probe: 0.90
Training classification probe
Creating model...
Number of training instances: 842
Number of classes: 4
Epoch: [1/10], Loss: 0.0124
Epoch: [2/10], Loss: 0.0100
Epoch: [3/10], Loss: 0.0089
Epoch: [4/10], Loss: 0.0081
Epoch: [5/10], Loss: 0.0074
Epoch: [6/10], Loss: 0.0069
Epoch: [7/10], Loss: 0.0064
Epoch: [8/10], Loss: 0.0060
Epoch: [9/10], Loss: 0.0056
Epoch: [10/10], Loss: 0.0052
Score (accuracy) of the probe: 0.88
Training classification probe
Creating model...
Number of training instances: 842
Number of classes: 4
Epoch: [1/10], Loss: 0.0133
Epoch: [2/10], Loss: 0.0109
Epoch: [3/10], Loss: 0.0098
Epoch: [4/10], Loss: 0.0089
Epoch: [5/10], Loss: 0.0083
Epoch: [6/10], Loss: 0.0077
Epoch: [7/10], Loss: 0.0072
Epoch: [8/10], Loss: 0.0068
Epoch: [9/10], Loss: 0.0065
Epoch: [10/10], Loss: 0.0062
Score (accuracy) of the probe: 0.90
The best l1=0, the best l2=0.001 for pretrained_BERT_layer_9
Accuracy on the test set of probing pretrained_BERT_layer_9 of all layers:
Score (accuracy) of the probe: 0.69
{'__OVERALL__': 0.6931567328918322, 'NAME': 0.7225, 'STRING': 1.0, 'NUMBER': 0.5185185185185185, 'KEYWORD': 0.3181818181818182}
Accuracy on the test set of pretrained_BERT_layer_9 model using the intercept:
Score (accuracy) of the probe: 0.88
pretrained_BERT Layer 10
Training classification probe
Creating model...
Number of training instances: 842
Number of classes: 4
Epoch: [1/10], Loss: 0.0125
Epoch: [2/10], Loss: 0.0101
Epoch: [3/10], Loss: 0.0090
Epoch: [4/10], Loss: 0.0082
Epoch: [5/10], Loss: 0.0076
Epoch: [6/10], Loss: 0.0070
Epoch: [7/10], Loss: 0.0066
Epoch: [8/10], Loss: 0.0061
Epoch: [9/10], Loss: 0.0058
Epoch: [10/10], Loss: 0.0054
Score (accuracy) of the probe: 0.86
Training classification probe
Creating model...
Number of training instances: 842
Number of classes: 4
Epoch: [1/10], Loss: 0.0122
Epoch: [2/10], Loss: 0.0100
Epoch: [3/10], Loss: 0.0089
Epoch: [4/10], Loss: 0.0082
Epoch: [5/10], Loss: 0.0076
Epoch: [6/10], Loss: 0.0070
Epoch: [7/10], Loss: 0.0066
Epoch: [8/10], Loss: 0.0061
Epoch: [9/10], Loss: 0.0058
Epoch: [10/10], Loss: 0.0054
Score (accuracy) of the probe: 0.87
Training classification probe
Creating model...
Number of training instances: 842
Number of classes: 4
Epoch: [1/10], Loss: 0.0130
Epoch: [2/10], Loss: 0.0106
Epoch: [3/10], Loss: 0.0095
Epoch: [4/10], Loss: 0.0086
Epoch: [5/10], Loss: 0.0080
Epoch: [6/10], Loss: 0.0074
Epoch: [7/10], Loss: 0.0069
Epoch: [8/10], Loss: 0.0065
Epoch: [9/10], Loss: 0.0061
Epoch: [10/10], Loss: 0.0057
Score (accuracy) of the probe: 0.87
Training classification probe
Creating model...
Number of training instances: 842
Number of classes: 4
Epoch: [1/10], Loss: 0.0137
Epoch: [2/10], Loss: 0.0113
Epoch: [3/10], Loss: 0.0103
Epoch: [4/10], Loss: 0.0095
Epoch: [5/10], Loss: 0.0088
Epoch: [6/10], Loss: 0.0082
Epoch: [7/10], Loss: 0.0078
Epoch: [8/10], Loss: 0.0074
Epoch: [9/10], Loss: 0.0070
Epoch: [10/10], Loss: 0.0067
Score (accuracy) of the probe: 0.88
The best l1=0, the best l2=0.1 for pretrained_BERT_layer_10
Accuracy on the test set of probing pretrained_BERT_layer_10 of all layers:
Score (accuracy) of the probe: 0.70
{'__OVERALL__': 0.6975717439293598, 'NAME': 0.7175, 'STRING': 1.0, 'NUMBER': 0.6296296296296297, 'KEYWORD': 0.36363636363636365}
Accuracy on the test set of pretrained_BERT_layer_10 model using the intercept:
Score (accuracy) of the probe: 0.88
pretrained_BERT Layer 11
Training classification probe
Creating model...
Number of training instances: 842
Number of classes: 4
Epoch: [1/10], Loss: 0.0129
Epoch: [2/10], Loss: 0.0105
Epoch: [3/10], Loss: 0.0094
Epoch: [4/10], Loss: 0.0086
Epoch: [5/10], Loss: 0.0080
Epoch: [6/10], Loss: 0.0074
Epoch: [7/10], Loss: 0.0069
Epoch: [8/10], Loss: 0.0065
Epoch: [9/10], Loss: 0.0061
Epoch: [10/10], Loss: 0.0058
Score (accuracy) of the probe: 0.86
Training classification probe
Creating model...
Number of training instances: 842
Number of classes: 4
Epoch: [1/10], Loss: 0.0120
Epoch: [2/10], Loss: 0.0098
Epoch: [3/10], Loss: 0.0088
Epoch: [4/10], Loss: 0.0080
Epoch: [5/10], Loss: 0.0074
Epoch: [6/10], Loss: 0.0069
Epoch: [7/10], Loss: 0.0064
Epoch: [8/10], Loss: 0.0060
Epoch: [9/10], Loss: 0.0057
Epoch: [10/10], Loss: 0.0053
Score (accuracy) of the probe: 0.89
Training classification probe
Creating model...
Number of training instances: 842
Number of classes: 4
Epoch: [1/10], Loss: 0.0127
Epoch: [2/10], Loss: 0.0103
Epoch: [3/10], Loss: 0.0092
Epoch: [4/10], Loss: 0.0085
Epoch: [5/10], Loss: 0.0078
Epoch: [6/10], Loss: 0.0073
Epoch: [7/10], Loss: 0.0069
Epoch: [8/10], Loss: 0.0064
Epoch: [9/10], Loss: 0.0061
Epoch: [10/10], Loss: 0.0058
Score (accuracy) of the probe: 0.86
Training classification probe
Creating model...
Number of training instances: 842
Number of classes: 4
Epoch: [1/10], Loss: 0.0140
Epoch: [2/10], Loss: 0.0115
Epoch: [3/10], Loss: 0.0104
Epoch: [4/10], Loss: 0.0096
Epoch: [5/10], Loss: 0.0089
Epoch: [6/10], Loss: 0.0084
Epoch: [7/10], Loss: 0.0079
Epoch: [8/10], Loss: 0.0075
Epoch: [9/10], Loss: 0.0072
Epoch: [10/10], Loss: 0.0068
Score (accuracy) of the probe: 0.89
The best l1=0, the best l2=0.001 for pretrained_BERT_layer_11
Accuracy on the test set of probing pretrained_BERT_layer_11 of all layers:
Score (accuracy) of the probe: 0.70
{'__OVERALL__': 0.7019867549668874, 'NAME': 0.7225, 'STRING': 1.0, 'NUMBER': 0.5185185185185185, 'KEYWORD': 0.5}
Accuracy on the test set of pretrained_BERT_layer_11 model using the intercept:
Score (accuracy) of the probe: 0.88
pretrained_BERT Layer 12
Training classification probe
Creating model...
Number of training instances: 842
Number of classes: 4
Epoch: [1/10], Loss: 0.0127
Epoch: [2/10], Loss: 0.0106
Epoch: [3/10], Loss: 0.0096
Epoch: [4/10], Loss: 0.0089
Epoch: [5/10], Loss: 0.0084
Epoch: [6/10], Loss: 0.0079
Epoch: [7/10], Loss: 0.0075
Epoch: [8/10], Loss: 0.0071
Epoch: [9/10], Loss: 0.0068
Epoch: [10/10], Loss: 0.0065
Score (accuracy) of the probe: 0.80
Training classification probe
Creating model...
Number of training instances: 842
Number of classes: 4
Epoch: [1/10], Loss: 0.0133
Epoch: [2/10], Loss: 0.0109
Epoch: [3/10], Loss: 0.0098
Epoch: [4/10], Loss: 0.0091
Epoch: [5/10], Loss: 0.0085
Epoch: [6/10], Loss: 0.0080
Epoch: [7/10], Loss: 0.0076
Epoch: [8/10], Loss: 0.0072
Epoch: [9/10], Loss: 0.0069
Epoch: [10/10], Loss: 0.0066
Score (accuracy) of the probe: 0.82
Training classification probe
Creating model...
Number of training instances: 842
Number of classes: 4
Epoch: [1/10], Loss: 0.0128
Epoch: [2/10], Loss: 0.0106
Epoch: [3/10], Loss: 0.0097
Epoch: [4/10], Loss: 0.0090
Epoch: [5/10], Loss: 0.0084
Epoch: [6/10], Loss: 0.0079
Epoch: [7/10], Loss: 0.0075
Epoch: [8/10], Loss: 0.0072
Epoch: [9/10], Loss: 0.0068
Epoch: [10/10], Loss: 0.0066
Score (accuracy) of the probe: 0.77
Training classification probe
Creating model...
Number of training instances: 842
Number of classes: 4
Epoch: [1/10], Loss: 0.0137
Epoch: [2/10], Loss: 0.0115
Epoch: [3/10], Loss: 0.0105
Epoch: [4/10], Loss: 0.0098
Epoch: [5/10], Loss: 0.0092
Epoch: [6/10], Loss: 0.0088
Epoch: [7/10], Loss: 0.0084
Epoch: [8/10], Loss: 0.0081
Epoch: [9/10], Loss: 0.0078
Epoch: [10/10], Loss: 0.0075
Score (accuracy) of the probe: 0.80
The best l1=0, the best l2=0.001 for pretrained_BERT_layer_12
Accuracy on the test set of probing pretrained_BERT_layer_12 of all layers:
Score (accuracy) of the probe: 0.59
{'__OVERALL__': 0.5938189845474614, 'NAME': 0.5975, 'STRING': 1.0, 'NUMBER': 0.6296296296296297, 'KEYWORD': 0.4090909090909091}
Accuracy on the test set of pretrained_BERT_layer_12 model using the intercept:
Score (accuracy) of the probe: 0.88
pretrained_BERT top neurons
array([6145,    2, 8197, 2056, 4104, 4108,   12,   13, 6159,   15, 4121,
       4122, 8218, 4124, 8222,   30,   31, 4132, 4133,   40, 8237, 2096,
       4147, 4154, 8250, 4155, 2116,   73, 8286,   94, 2144,  101, 4197,
       6250, 2155, 2157, 2167,  121, 8320, 8322, 2182,  139, 8331, 4237,
       8341, 6294, 6295,  149, 2208, 6305,  165, 4264, 2237,  190,  189,
        195,  199,  203, 4306,  213, 6359, 4314,  231, 2280,  232, 4327,
       6382, 2286, 2288, 4343,  252,  258,  262, 2315,  269, 6423,  282,
       6428, 6429, 6434, 6440, 6443,  307, 6459, 6464, 2375,  330, 2380,
       8525, 2381,  335,  336, 4440,  346,  351, 8547, 6501,  357,  363,
       4470, 4472,  380, 8572, 4477,  383,  384, 8575, 6534, 6537, 4498,
       4501,  405, 4503, 2457, 6568,  425, 4525, 4528, 8624, 4530,  436,
       4541, 4550, 8647,  455, 2507,  464, 6609, 6611,  475, 2523, 4574,
       8673, 2531, 4582, 4590, 8687, 2543, 8696,  505, 8698, 8700, 6661,
       8709, 2568,  521, 8712, 4619,  522, 6672,  534, 8727, 2585,  538,
        539, 4636, 8733,  541, 8739, 4644, 2597,  550, 8744, 6698, 8749,
        560, 4657, 2612,  565, 2624, 8768, 4679,  593, 6740,  598,  599,
        607,  608, 2659, 2661, 2663, 4716, 2669, 4718, 6774, 8825,  635,
       6784,  646, 8838, 8841, 6797,  654,  656,  663,  669, 4773, 8869,
       6822,  690, 6843,  701, 6845, 4804,  709, 6854, 2757, 8912, 8913,
       8915, 8917,  726,  736,  737, 4843, 8939, 4845,  750, 6893,  752,
       6896, 4851, 2804,  759, 8952, 2818, 6915, 8965, 2821, 4872, 2829,
       2843, 6940, 8990,  808, 9003, 9005, 6957, 4920, 4922, 4923, 4928,
       9028, 9033, 6989, 2903, 9054, 2912, 7011, 7013, 7020,  878, 7022,
        880,  885,  886, 2935, 4988,  893, 9088,  913, 7058, 7060, 9111,
        921, 2976, 9129, 9131, 5046, 7100, 3004, 7105,  963, 9156, 7108,
       3014,  978,  981, 9176, 5088, 3048, 1000, 7150, 1008, 9203, 7157,
       5111, 1016, 9220, 1030, 5128, 5129, 7181, 7182, 1043, 3093, 7191,
       7197, 7202, 1063, 1071, 1072, 1073, 1075, 1076, 1083, 9281, 5187,
       7239, 1096, 7243, 1101, 1104, 1105, 7252, 5208, 5213, 1125, 3181,
       5240, 5245, 7298, 5254, 7305, 1165, 3215, 7312, 9361, 5267, 9365,
       3225, 9374, 7333, 1193, 7340, 1197, 1199, 5296, 7346, 7355, 9404,
       5307, 3267, 7366, 9418, 3275, 1239, 7386, 7392, 9441, 3299, 7403,
       3309, 7420, 9468, 7429, 7432, 9480, 5387, 7436, 5390, 1308, 3356,
       1309, 3365, 3369, 7469, 5421, 9517, 3386, 1339, 1343, 3392, 9536,
       1359, 9556, 3416, 1368, 5467, 9565, 5472, 1376, 5477, 1387, 5484,
       3437, 1401, 7550, 7552, 1414, 9609, 5527, 7579, 1437, 1440, 3488,
       5538, 7589, 3496, 3510, 9654, 9658, 1469, 7616, 1477, 1485, 9680,
       9681, 7636, 1494, 9690, 3546, 1507, 3559, 9709, 1518, 1525, 9720,
       1531, 3580, 9733, 5644, 3606, 5660, 1566, 9771, 7725, 9781, 5688,
       5690, 9788, 5696, 3650, 9796, 7757, 5712, 3671, 7779, 5732, 7790,
       7799, 7810, 5766, 3719, 5769, 3730, 7826, 5780, 3735, 7838, 3755,
       9909, 5826, 1731, 7876, 5829, 3782, 1739, 1742, 3791, 3806, 7905,
       9955, 1765, 7930, 1788, 1789, 3861, 7959, 5911, 7964, 7971, 5931,
       3889, 1843, 1844, 7995, 1851, 1869, 1884, 8030, 1893, 1895, 8039,
       3964, 8064, 8066, 6034, 8087, 3993, 4005, 6054, 1972, 4020, 8118,
       8123, 1985, 8135, 4046, 8145, 8147, 6102, 8154, 8160, 4077, 2036,
       2039, 4095])
pretrained_BERT top neurons per class
{'NAME': array([4314,  307, 7552, 7905, 7181, 1075, 4147, 2144, 6672, 4530, 2612,
       5472, 1844,  199, 6423, 7432, 9111, 7058,  701, 3048, 6464, 1076,
       3369, 9088, 7959, 1469, 6784, 1101, 1083, 1972, 1731, 7429, 3267,
       8320, 8687,  436, 8727, 3730, 7386,  752, 4501, 3650, 2912, 9796,
        203, 1742, 1008, 1518,  880, 2818, 8322, 3791, 1239, 8952, 6250,
       1494, 3861, 4154, 3889,   73, 8123, 6294, 8700, 3735, 7020, 6854,
       6034, 4343, 1376, 8547, 6382, 3782, 8917,  963, 8030, 7589, 8733,
       7420, 3392, 5660, 4132, 4440, 6501, 2237, 9955,  195, 8087,  380,
       6428, 9028,  190, 5911, 1401, 2568,  808, 4472, 4108, 5245,   12,
       4922, 1566, 5128, 6359, 6459, 7876,  663, 9203, 5187,  384,  383,
       3510, 7469,  690, 5690, 3416, 8237, 7826, 6434, 3014,  330, 7333,
       2507, 9709, 5111, 2624, 5484, 4528,  981, 5644, 7011, 1739, 6843,
       1308, 2056, 2286, 4237, 4005,  608, 7995, 7182, 8064, 1843, 5267,
       9609, 4988, 6915, 8066, 4550]), 'STRING': array([1376,  701, 7305,  521,  538, 2096, 3861, 4077, 2829, 2912, 6845,
       9733, 5088, 9658, 6661,  565, 3225, 1043, 5046, 9680, 8913, 9796,
        752, 2457, 6428, 7392, 9203,  534, 2531, 1105,  560,  425, 1193,
       5538, 9404, 8673, 7905,  539, 9176, 7105, 4679,  505, 9156, 8647,
       4528, 1765,  351,  252,  269, 5477, 1972, 6611, 5826, 4636, 1437,
       9771, 8841, 6609,  893, 1788, 8965, 9281, 9681, 5527, 3309,  963,
       5129, 6537, 8222, 7202, 1308, 4264, 5307, 9374,  750, 3048,  669,
       8912, 9131, 7355, 8525, 8696, 9361, 2286, 6774,  726, 1096, 8145,
       8250,  405, 6443,  921, 9565, 1063, 7550, 8990, 8147,  475, 2375,
       8160, 7060, 9720,  101, 8749, 9033,  737, 2843, 1507,  593, 4237,
        885, 9468, 1789, 9480,  464,  213, 6940, 4095, 5467, 4590, 2380,
       4470, 1531, 3093, 4845, 7838, 1165, 1884, 9690,  262, 9003, 7100,
       7108, 9536, 2036,  656, 4503, 9418,  383, 2208, 3546, 4804, 6159,
       4872, 7799, 9088, 1030, 9781, 3993, 1359, 5421, 3004, 1869, 9788,
       4525, 7964, 9517, 6305, 8709, 4773]), 'NUMBER': array([ 599,  635, 2280, 2144, 3365, 9203, 7252, 2912,   30,   40,  598,
       1075, 4928,  808, 6464, 7191, 7757, 4197, 2116,  978,   15, 7157,
       1199,  384, 4582, 6428,  262, 2531, 1893, 6459, 1101, 5296, 1368,
       1731, 1387, 6940, 7298,  363, 6423, 9365, 8712, 9955, 5484, 8768,
       1477, 6443, 8066,  646, 4923, 1414,  709, 2661, 2663, 8917, 6797,
        886, 7436, 4843, 4657,  607, 8673,  654,   13, 5688, 8825, 8915,
       6382,  139, 5769, 5254, 1016, 3299, 3437,  521, 6102, 3386, 8739,
       1895, 8135, 7725,  759, 5712, 1440, 7312, 1518, 3755, 1000, 7346,
       1485, 4920, 2804, 8341, 1104, 7150,  307, 6568, 5780, 8118,  199,
       6534, 6295, 1985,  231, 9005, 7905, 2568,  232, 2976,  878, 2669,
       3964, 7058, 3488, 8939, 4644, 2167, 4851, 6989, 8039,  346, 8286,
       9054, 1343, 3225, 8572, 1125, 7366, 3392, 8952, 7930, 6893, 5931,
       7403, 4133, 2039, 7790, 5208, 4104, 4122,  550, 7013, 4155,  357,
        282, 6698, 2315, 5240,  189, 4477, 6896, 2757, 1072, 9129, 8838,
       9909, 2288, 2935, 2182, 5732, 9654, 8218]), 'KEYWORD': array([ 599, 7959, 5129, 2144, 4619, 8575, 8673,  383, 1083, 8320, 9088,
       1893,  752, 5527, 3730, 4046, 3671, 3559, 1368, 2829, 3606, 9033,
       2507, 6464, 3181,  262, 7011, 6440, 1071, 5390, 7013, 2821, 2531,
       1525,    2, 2935, 7340, 9796, 1339, 3309, 4124, 1851, 3369, 1075,
       3275, 6429, 1376, 7429, 2597, 1742, 8222,  336, 6740, 8869, 4121,
       8624, 8838, 9203, 3806, 3356, 1197,  335, 3889,  121, 7810, 4498,
       2903, 3719, 4574, 6797, 4541, 2543, 8965, 2237, 6822, 4327, 3735,
       8197,   40, 7636, 3580, 6501, 7579, 2659, 5829, 3510, 8744, 5766,
       3215, 8331,   94, 4314, 8739, 1073, 9654,  282,  258, 7202, 6054,
       5421,   31,  165, 4590,  405, 7022, 1309, 4872,  455, 3496,  737,
       8087, 7355, 5696, 4306, 8915, 6957, 4716,   73, 7197, 1843, 7239,
       2585, 2568, 8154, 2157,  541, 9220, 4477, 7191, 7616, 8712, 7779,
       1469, 2523,  913, 4528, 2155, 7971, 6145,  736, 9556, 7386, 2381,
       9418, 8698,  149, 7243,  522, 4020, 7366, 4718, 9441, 5387, 1076,
       5213, 4503])}
The shape of selected features (842, 508)
The shape of the training set: (842, 9984)
The shape of the validation set: (94, 9984)
The shape of the testing set: (453, 9984)
Training classification probe
Creating model...
Number of training instances: 842
Number of classes: 4
Epoch: [1/10], Loss: 0.0116
Epoch: [2/10], Loss: 0.0096
Epoch: [3/10], Loss: 0.0083
Epoch: [4/10], Loss: 0.0072
Epoch: [5/10], Loss: 0.0064
Epoch: [6/10], Loss: 0.0057
Epoch: [7/10], Loss: 0.0051
Epoch: [8/10], Loss: 0.0046
Epoch: [9/10], Loss: 0.0042
Epoch: [10/10], Loss: 0.0038
Score (accuracy) of the probe: 0.93
Training classification probe
Creating model...
Number of training instances: 842
Number of classes: 4
Epoch: [1/10], Loss: 0.0134
Epoch: [2/10], Loss: 0.0108
Epoch: [3/10], Loss: 0.0093
Epoch: [4/10], Loss: 0.0081
Epoch: [5/10], Loss: 0.0072
Epoch: [6/10], Loss: 0.0064
Epoch: [7/10], Loss: 0.0057
Epoch: [8/10], Loss: 0.0052
Epoch: [9/10], Loss: 0.0047
Epoch: [10/10], Loss: 0.0043
Score (accuracy) of the probe: 0.90
Training classification probe
Creating model...
Number of training instances: 842
Number of classes: 4
Epoch: [1/10], Loss: 0.0120
Epoch: [2/10], Loss: 0.0098
Epoch: [3/10], Loss: 0.0085
Epoch: [4/10], Loss: 0.0074
Epoch: [5/10], Loss: 0.0065
Epoch: [6/10], Loss: 0.0058
Epoch: [7/10], Loss: 0.0053
Epoch: [8/10], Loss: 0.0048
Epoch: [9/10], Loss: 0.0043
Epoch: [10/10], Loss: 0.0040
Score (accuracy) of the probe: 0.90
Training classification probe
Creating model...
Number of training instances: 842
Number of classes: 4
Epoch: [1/10], Loss: 0.0132
Epoch: [2/10], Loss: 0.0111
Epoch: [3/10], Loss: 0.0097
Epoch: [4/10], Loss: 0.0086
Epoch: [5/10], Loss: 0.0077
Epoch: [6/10], Loss: 0.0070
Epoch: [7/10], Loss: 0.0064
Epoch: [8/10], Loss: 0.0059
Epoch: [9/10], Loss: 0.0055
Epoch: [10/10], Loss: 0.0052
Score (accuracy) of the probe: 0.90
The best l1=0, the best l2=0 for pretrained_BERT_top5%_neurons
Accuracy on the test set of probing pretrained_BERT_top5%_neurons of all layers:
Score (accuracy) of the probe: 0.76
{'__OVERALL__': 0.7593818984547461, 'NAME': 0.775, 'STRING': 1.0, 'NUMBER': 0.7777777777777778, 'KEYWORD': 0.4090909090909091}
Accuracy on the test set of pretrained_BERT_top5%_neurons model using the intercept:
Score (accuracy) of the probe: 0.88
Training classification probe
Creating model...
Number of training instances: 842
Number of classes: 4
Epoch: [1/10], Loss: 0.0123
Epoch: [2/10], Loss: 0.0112
Epoch: [3/10], Loss: 0.0104
Epoch: [4/10], Loss: 0.0098
Epoch: [5/10], Loss: 0.0092
Epoch: [6/10], Loss: 0.0087
Epoch: [7/10], Loss: 0.0083
Epoch: [8/10], Loss: 0.0079
Epoch: [9/10], Loss: 0.0075
Epoch: [10/10], Loss: 0.0072
Score (accuracy) of the probe: 0.78
Training classification probe
Creating model...
Number of training instances: 842
Number of classes: 4
Epoch: [1/10], Loss: 0.0126
Epoch: [2/10], Loss: 0.0115
Epoch: [3/10], Loss: 0.0106
Epoch: [4/10], Loss: 0.0099
Epoch: [5/10], Loss: 0.0094
Epoch: [6/10], Loss: 0.0089
Epoch: [7/10], Loss: 0.0084
Epoch: [8/10], Loss: 0.0080
Epoch: [9/10], Loss: 0.0076
Epoch: [10/10], Loss: 0.0073
Score (accuracy) of the probe: 0.73
Training classification probe
Creating model...
Number of training instances: 842
Number of classes: 4
Epoch: [1/10], Loss: 0.0125
Epoch: [2/10], Loss: 0.0115
Epoch: [3/10], Loss: 0.0107
Epoch: [4/10], Loss: 0.0101
Epoch: [5/10], Loss: 0.0095
Epoch: [6/10], Loss: 0.0090
Epoch: [7/10], Loss: 0.0086
Epoch: [8/10], Loss: 0.0081
Epoch: [9/10], Loss: 0.0078
Epoch: [10/10], Loss: 0.0074
Score (accuracy) of the probe: 0.84
Training classification probe
Creating model...
Number of training instances: 842
Number of classes: 4
Epoch: [1/10], Loss: 0.0130
Epoch: [2/10], Loss: 0.0120
Epoch: [3/10], Loss: 0.0112
Epoch: [4/10], Loss: 0.0106
Epoch: [5/10], Loss: 0.0101
Epoch: [6/10], Loss: 0.0096
Epoch: [7/10], Loss: 0.0092
Epoch: [8/10], Loss: 0.0088
Epoch: [9/10], Loss: 0.0085
Epoch: [10/10], Loss: 0.0082
Score (accuracy) of the probe: 0.83
The best l1=0, the best l2=0.01 for pretrained_BERT_top200_neurons
Accuracy on the test set of probing pretrained_BERT_top200_neurons of all layers:
Score (accuracy) of the probe: 0.70
{'__OVERALL__': 0.6975717439293598, 'NAME': 0.7275, 'STRING': 1.0, 'NUMBER': 0.6296296296296297, 'KEYWORD': 0.18181818181818182}
Accuracy on the test set of pretrained_BERT_top200_neurons model using the intercept:
Score (accuracy) of the probe: 0.88
Creating control dataset for pretrained_BERT POS tagging task
Training classification probe
Creating model...
Number of training instances: 842
Number of classes: 4
Epoch: [1/10], Loss: 0.0146
Epoch: [2/10], Loss: 0.0102
Epoch: [3/10], Loss: 0.0080
Epoch: [4/10], Loss: 0.0068
Epoch: [5/10], Loss: 0.0054
Epoch: [6/10], Loss: 0.0054
Epoch: [7/10], Loss: 0.0044
Epoch: [8/10], Loss: 0.0049
Epoch: [9/10], Loss: 0.0033
Epoch: [10/10], Loss: 0.0031
Score (accuracy) of the probe: 0.21
Training classification probe
Creating model...
Number of training instances: 842
Number of classes: 4
Epoch: [1/10], Loss: 0.0144
Epoch: [2/10], Loss: 0.0101
Epoch: [3/10], Loss: 0.0076
Epoch: [4/10], Loss: 0.0061
Epoch: [5/10], Loss: 0.0049
Epoch: [6/10], Loss: 0.0043
Epoch: [7/10], Loss: 0.0040
Epoch: [8/10], Loss: 0.0044
Epoch: [9/10], Loss: 0.0038
Epoch: [10/10], Loss: 0.0047
Score (accuracy) of the probe: 0.16
Training classification probe
Creating model...
Number of training instances: 842
Number of classes: 4
Epoch: [1/10], Loss: 0.0146
Epoch: [2/10], Loss: 0.0103
Epoch: [3/10], Loss: 0.0079
Epoch: [4/10], Loss: 0.0064
Epoch: [5/10], Loss: 0.0053
Epoch: [6/10], Loss: 0.0043
Epoch: [7/10], Loss: 0.0038
Epoch: [8/10], Loss: 0.0035
Epoch: [9/10], Loss: 0.0034
Epoch: [10/10], Loss: 0.0035
Score (accuracy) of the probe: 0.23
Training classification probe
Creating model...
Number of training instances: 842
Number of classes: 4
Epoch: [1/10], Loss: 0.0154
Epoch: [2/10], Loss: 0.0115
Epoch: [3/10], Loss: 0.0085
Epoch: [4/10], Loss: 0.0072
Epoch: [5/10], Loss: 0.0063
Epoch: [6/10], Loss: 0.0055
Epoch: [7/10], Loss: 0.0050
Epoch: [8/10], Loss: 0.0048
Epoch: [9/10], Loss: 0.0045
Epoch: [10/10], Loss: 0.0044
Score (accuracy) of the probe: 0.19
The best l1=0, the best l2=0.01 for pretrained_BERT_control_task
Accuracy on the test set of probing pretrained_BERT_control_task of all layers:
Score (accuracy) of the probe: 0.31
{'__OVERALL__': 0.31346578366445915, 'NAME': 0.3333333333333333, 'STRING': 0.3877551020408163, 'NUMBER': 0.3142857142857143, 'KEYWORD': 0.23140495867768596}
Accuracy on the test set of pretrained_BERT_control_task model using the intercept:
Score (accuracy) of the probe: 0.28
pretrained_BERT_control_task Selectivity (Diff. between true task and probing task performance):  0.509933774834437
----------------------------------------------------------------
