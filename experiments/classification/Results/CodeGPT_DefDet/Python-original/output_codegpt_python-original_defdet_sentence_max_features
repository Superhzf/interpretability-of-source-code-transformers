[MEMORY] Begin: 258.36
*********************** LOADING ACTIVATIONS ***********************
[MEMORY] Before activation loading: 258.36
Loading json activations from /work/LAS/jannesar-lab/arushi/Redundancy/Defect-detection/dataset/activations/codegpt/java-original/train_activations.json...
21854 13.0
Loading json activations from /work/LAS/jannesar-lab/arushi/Redundancy/Defect-detection/dataset/activations/codegpt/java-original/dev_activations.json...
2732 13.0
Number of train sentences: 21854
Number of test sentences: 2732
[MEMORY] After activation loading: 2438.40
************************* LOADING TOKENS **************************
[MEMORY] After token loading: 2444.88
************************ CREATING TENSORS *************************
Train:
Number of tokens:  21854
length of source dictionary:  21854
length of target dictionary:  2
21854
Total instances: 21854
['sentence_18428', 'sentence_15673', 'sentence_8657', 'sentence_10048', 'sentence_296', 'sentence_1251', 'sentence_9344', 'sentence_20160', 'sentence_1404', 'sentence_10791', 'sentence_15105', 'sentence_6456', 'sentence_6156', 'sentence_15889', 'sentence_18927', 'sentence_6275', 'sentence_18505', 'sentence_18750', 'sentence_6534', 'sentence_19090']
(19668, 9984) (19668,)
Dev:
(2186, 9984) (2186,)
Test:
Number of tokens:  2732
length of source dictionary:  21854
length of target dictionary:  2
2732
Total instances: 2732
['sentence_726', 'sentence_2336', 'sentence_1990', 'sentence_862', 'sentence_1792', 'sentence_2564', 'sentence_278', 'sentence_919', 'sentence_231', 'sentence_23', 'sentence_396', 'sentence_1598', 'sentence_1599', 'sentence_2160', 'sentence_876', 'sentence_1723', 'sentence_2555', 'sentence_1558', 'sentence_1988', 'sentence_1861']
(2732, 9984) (2732,)
[MEMORY] After tensor creation: 4222.23
************************* FREEING MEMORY **************************
[MEMORY] After cleanup: 4218.04
***************** RUNNING BASELINE [ ALL LAYERS ] *****************
Building model...
Train: (19668, 9984) (19668,)
Dev: (2186, 9984) (2186,)
Test: (2732, 9984) (2732,)
Training classification model
Creating model...
Number of training instances: 19668
Number of classes: 2
Epoch: [1/10], Loss: 0.0254
Epoch: [2/10], Loss: 0.0204
Epoch: [3/10], Loss: 0.0195
Epoch: [4/10], Loss: 0.0179
Epoch: [5/10], Loss: 0.0213
Epoch: [6/10], Loss: 0.0217
Epoch: [7/10], Loss: 0.0206
Epoch: [8/10], Loss: 0.0221
Epoch: [9/10], Loss: 0.0182
Epoch: [10/10], Loss: 0.0194
Score (accuracy) of the model: 0.72
Score (accuracy) of the model: 0.70
Score (accuracy) of the model: 0.62
Results:
Train Score (accuracy): 0.722493
Dev Score (accuracy): 0.700366
Test Score (accuracy): 0.618960
[MEMORY] After baseline run: 4222.09
********************* RUNNING NEURON SELECTION *********************
------------- Clustering (threshold -1.00) ----------
Building model...
Train: (19668, 9984) (19668,)
Dev: (2186, 9984) (2186,)
Test: (2732, 9984) (2732,)
Training classification model
Creating model...
Number of training instances: 19668
Number of classes: 2
Epoch: [1/10], Loss: 0.0305
Epoch: [2/10], Loss: 0.0204
Epoch: [3/10], Loss: 0.0188
Epoch: [4/10], Loss: 0.0188
Epoch: [5/10], Loss: 0.0228
Epoch: [6/10], Loss: 0.0251
Epoch: [7/10], Loss: 0.0180
Epoch: [8/10], Loss: 0.0197
Epoch: [9/10], Loss: 0.0194
Epoch: [10/10], Loss: 0.0188
Score (accuracy) of the model: 0.73
Score (accuracy) of the model: 0.71
Score (accuracy) of the model: 0.62
Results:
Train Score (accuracy): 0.727883
Dev Score (accuracy): 0.712260
Test Score (accuracy): 0.617496
Gold score (Baseline with selected top layer [and potential clustering]): 0.712260
Target score (1% drop): 0.705137
Getting neuron ranking...
Searching for minimal neuron set...
------------- Retraining with 9 neurons (0.10% of total) -------------
Building model...
Train: (19668, 9) (19668,)
Dev: (2186, 9) (2186,)
Test: (2732, 9) (2732,)
Training classification model
Creating model...
Number of training instances: 19668
Number of classes: 2
Epoch: [1/10], Loss: 0.0124
Epoch: [2/10], Loss: 0.0116
Epoch: [3/10], Loss: 0.0114
Epoch: [4/10], Loss: 0.0113
Epoch: [5/10], Loss: 0.0113
Epoch: [6/10], Loss: 0.0113
Epoch: [7/10], Loss: 0.0113
Epoch: [8/10], Loss: 0.0112
Epoch: [9/10], Loss: 0.0112
Epoch: [10/10], Loss: 0.0112
Score (accuracy) of the model: 0.64
Score (accuracy) of the model: 0.65
Score (accuracy) of the model: 0.59
Results:
Train Score (accuracy): 0.640990
Dev Score (accuracy): 0.654163
Test Score (accuracy): 0.594802
------------- Retraining with 19 neurons (0.20% of total) -------------
Building model...
Train: (19668, 19) (19668,)
Dev: (2186, 19) (2186,)
Test: (2732, 19) (2732,)
Training classification model
Creating model...
Number of training instances: 19668
Number of classes: 2
Epoch: [1/10], Loss: 0.0117
Epoch: [2/10], Loss: 0.0111
Epoch: [3/10], Loss: 0.0110
Epoch: [4/10], Loss: 0.0109
Epoch: [5/10], Loss: 0.0109
Epoch: [6/10], Loss: 0.0109
Epoch: [7/10], Loss: 0.0109
Epoch: [8/10], Loss: 0.0109
Epoch: [9/10], Loss: 0.0109
Epoch: [10/10], Loss: 0.0109
Score (accuracy) of the model: 0.66
Score (accuracy) of the model: 0.67
Score (accuracy) of the model: 0.60
Results:
Train Score (accuracy): 0.657871
Dev Score (accuracy): 0.666057
Test Score (accuracy): 0.599927
------------- Retraining with 29 neurons (0.30% of total) -------------
Building model...
Train: (19668, 29) (19668,)
Dev: (2186, 29) (2186,)
Test: (2732, 29) (2732,)
Training classification model
Creating model...
Number of training instances: 19668
Number of classes: 2
Epoch: [1/10], Loss: 0.0116
Epoch: [2/10], Loss: 0.0110
Epoch: [3/10], Loss: 0.0109
Epoch: [4/10], Loss: 0.0108
Epoch: [5/10], Loss: 0.0108
Epoch: [6/10], Loss: 0.0108
Epoch: [7/10], Loss: 0.0108
Epoch: [8/10], Loss: 0.0108
Epoch: [9/10], Loss: 0.0108
Epoch: [10/10], Loss: 0.0108
Score (accuracy) of the model: 0.67
Score (accuracy) of the model: 0.68
Score (accuracy) of the model: 0.60
Results:
Train Score (accuracy): 0.666006
Dev Score (accuracy): 0.679323
Test Score (accuracy): 0.595900
------------- Retraining with 39 neurons (0.40% of total) -------------
Building model...
Train: (19668, 39) (19668,)
Dev: (2186, 39) (2186,)
Test: (2732, 39) (2732,)
Training classification model
Creating model...
Number of training instances: 19668
Number of classes: 2
Epoch: [1/10], Loss: 0.0116
Epoch: [2/10], Loss: 0.0108
Epoch: [3/10], Loss: 0.0107
Epoch: [4/10], Loss: 0.0107
Epoch: [5/10], Loss: 0.0106
Epoch: [6/10], Loss: 0.0106
Epoch: [7/10], Loss: 0.0106
Epoch: [8/10], Loss: 0.0106
Epoch: [9/10], Loss: 0.0106
Epoch: [10/10], Loss: 0.0106
Score (accuracy) of the model: 0.68
Score (accuracy) of the model: 0.68
Score (accuracy) of the model: 0.61
Results:
Train Score (accuracy): 0.675869
Dev Score (accuracy): 0.681610
Test Score (accuracy): 0.607613
------------- Retraining with 49 neurons (0.50% of total) -------------
Building model...
Train: (19668, 49) (19668,)
Dev: (2186, 49) (2186,)
Test: (2732, 49) (2732,)
Training classification model
Creating model...
Number of training instances: 19668
Number of classes: 2
Epoch: [1/10], Loss: 0.0113
Epoch: [2/10], Loss: 0.0107
Epoch: [3/10], Loss: 0.0106
Epoch: [4/10], Loss: 0.0106
Epoch: [5/10], Loss: 0.0105
Epoch: [6/10], Loss: 0.0105
Epoch: [7/10], Loss: 0.0105
Epoch: [8/10], Loss: 0.0105
Epoch: [9/10], Loss: 0.0105
Epoch: [10/10], Loss: 0.0105
Score (accuracy) of the model: 0.68
Score (accuracy) of the model: 0.69
Score (accuracy) of the model: 0.61
Results:
Train Score (accuracy): 0.681462
Dev Score (accuracy): 0.688930
Test Score (accuracy): 0.612738
------------- Retraining with 59 neurons (0.60% of total) -------------
Building model...
Train: (19668, 59) (19668,)
Dev: (2186, 59) (2186,)
Test: (2732, 59) (2732,)
Training classification model
Creating model...
Number of training instances: 19668
Number of classes: 2
Epoch: [1/10], Loss: 0.0114
Epoch: [2/10], Loss: 0.0107
Epoch: [3/10], Loss: 0.0105
Epoch: [4/10], Loss: 0.0105
Epoch: [5/10], Loss: 0.0105
Epoch: [6/10], Loss: 0.0105
Epoch: [7/10], Loss: 0.0105
Epoch: [8/10], Loss: 0.0105
Epoch: [9/10], Loss: 0.0105
Epoch: [10/10], Loss: 0.0105
Score (accuracy) of the model: 0.68
Score (accuracy) of the model: 0.69
Score (accuracy) of the model: 0.61
Results:
Train Score (accuracy): 0.684818
Dev Score (accuracy): 0.685727
Test Score (accuracy): 0.608346
------------- Retraining with 69 neurons (0.70% of total) -------------
Building model...
Train: (19668, 69) (19668,)
Dev: (2186, 69) (2186,)
Test: (2732, 69) (2732,)
Training classification model
Creating model...
Number of training instances: 19668
Number of classes: 2
Epoch: [1/10], Loss: 0.0112
Epoch: [2/10], Loss: 0.0105
Epoch: [3/10], Loss: 0.0104
Epoch: [4/10], Loss: 0.0104
Epoch: [5/10], Loss: 0.0104
Epoch: [6/10], Loss: 0.0104
Epoch: [7/10], Loss: 0.0104
Epoch: [8/10], Loss: 0.0104
Epoch: [9/10], Loss: 0.0104
Epoch: [10/10], Loss: 0.0104
Score (accuracy) of the model: 0.69
Score (accuracy) of the model: 0.69
Score (accuracy) of the model: 0.62
Results:
Train Score (accuracy): 0.686648
Dev Score (accuracy): 0.690759
Test Score (accuracy): 0.616764
------------- Retraining with 79 neurons (0.80% of total) -------------
Building model...
Train: (19668, 79) (19668,)
Dev: (2186, 79) (2186,)
Test: (2732, 79) (2732,)
Training classification model
Creating model...
Number of training instances: 19668
Number of classes: 2
Epoch: [1/10], Loss: 0.0112
Epoch: [2/10], Loss: 0.0105
Epoch: [3/10], Loss: 0.0104
Epoch: [4/10], Loss: 0.0103
Epoch: [5/10], Loss: 0.0103
Epoch: [6/10], Loss: 0.0103
Epoch: [7/10], Loss: 0.0103
Epoch: [8/10], Loss: 0.0103
Epoch: [9/10], Loss: 0.0103
Epoch: [10/10], Loss: 0.0103
Score (accuracy) of the model: 0.69
Score (accuracy) of the model: 0.71
Score (accuracy) of the model: 0.62
Results:
Train Score (accuracy): 0.691224
Dev Score (accuracy): 0.706313
Test Score (accuracy): 0.616032
[MEMORY] After neuron selection: 4222.19
***************************** SUMMARY *****************************
Baseline Score (accuracy): 0.618960
Clustering paramter: no-clustering
Minimal set of neurons: 79 neurons
Minimal set score (accuracy): 0.616032
