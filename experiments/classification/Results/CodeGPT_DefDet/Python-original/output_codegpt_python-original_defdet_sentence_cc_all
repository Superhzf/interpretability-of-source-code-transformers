[MEMORY] Begin: 260.63
*********************** LOADING ACTIVATIONS ***********************
[MEMORY] Before activation loading: 260.82
Loading json activations from /work/LAS/jannesar-lab/arushi/Redundancy/Defect-detection/dataset/activations/codegpt/java-original/train_activations.json...
21854 13.0
Loading json activations from /work/LAS/jannesar-lab/arushi/Redundancy/Defect-detection/dataset/activations/codegpt/java-original/dev_activations.json...
2732 13.0
Number of train sentences: 21854
Number of test sentences: 2732
[MEMORY] After activation loading: 2440.88
************************* LOADING TOKENS **************************
[MEMORY] After token loading: 2447.36
************************ CREATING TENSORS *************************
Train:
Number of tokens:  21854
length of source dictionary:  21854
length of target dictionary:  2
21854
Total instances: 21854
['sentence_8542', 'sentence_7875', 'sentence_15284', 'sentence_14431', 'sentence_3582', 'sentence_14563', 'sentence_18286', 'sentence_8807', 'sentence_15164', 'sentence_2171', 'sentence_8481', 'sentence_18021', 'sentence_5588', 'sentence_21331', 'sentence_18572', 'sentence_6367', 'sentence_4183', 'sentence_12315', 'sentence_19703', 'sentence_2144']
(19668, 9984) (19668,)
Dev:
(2186, 9984) (2186,)
Test:
Number of tokens:  2732
length of source dictionary:  21854
length of target dictionary:  2
2732
Total instances: 2732
['sentence_2045', 'sentence_888', 'sentence_7', 'sentence_894', 'sentence_2391', 'sentence_2512', 'sentence_2217', 'sentence_647', 'sentence_1158', 'sentence_281', 'sentence_737', 'sentence_803', 'sentence_2378', 'sentence_934', 'sentence_2723', 'sentence_733', 'sentence_622', 'sentence_1965', 'sentence_557', 'sentence_544']
(2732, 9984) (2732,)
[MEMORY] After tensor creation: 4224.65
************************* FREEING MEMORY **************************
[MEMORY] After cleanup: 4219.82
***************** RUNNING BASELINE [ ALL LAYERS ] *****************
Building model...
Train: (19668, 9984) (19668,)
Dev: (2186, 9984) (2186,)
Test: (2732, 9984) (2732,)
Training classification model
Creating model...
Number of training instances: 19668
Number of classes: 2
Epoch: [1/10], Loss: 0.0272
Epoch: [2/10], Loss: 0.0199
Epoch: [3/10], Loss: 0.0187
Epoch: [4/10], Loss: 0.0175
Epoch: [5/10], Loss: 0.0204
Epoch: [6/10], Loss: 0.0228
Epoch: [7/10], Loss: 0.0176
Epoch: [8/10], Loss: 0.0189
Epoch: [9/10], Loss: 0.0218
Epoch: [10/10], Loss: 0.0185
Score (accuracy) of the model: 0.73
Score (accuracy) of the model: 0.70
Score (accuracy) of the model: 0.61
Results:
Train Score (accuracy): 0.727934
Dev Score (accuracy): 0.697164
Test Score (accuracy): 0.611274
[MEMORY] After baseline run: 4223.42
********************* RUNNING NEURON SELECTION *********************
------------- Clustering (threshold -1.00) ----------
Building model...
Train: (19668, 9984) (19668,)
Dev: (2186, 9984) (2186,)
Test: (2732, 9984) (2732,)
Training classification model
Creating model...
Number of training instances: 19668
Number of classes: 2
Epoch: [1/10], Loss: 0.0358
Epoch: [2/10], Loss: 0.0185
Epoch: [3/10], Loss: 0.0208
Epoch: [4/10], Loss: 0.0213
Epoch: [5/10], Loss: 0.0213
Epoch: [6/10], Loss: 0.0207
Epoch: [7/10], Loss: 0.0188
Epoch: [8/10], Loss: 0.0214
Epoch: [9/10], Loss: 0.0222
Epoch: [10/10], Loss: 0.0181
Score (accuracy) of the model: 0.70
Score (accuracy) of the model: 0.68
Score (accuracy) of the model: 0.64
Results:
Train Score (accuracy): 0.701342
Dev Score (accuracy): 0.684355
Test Score (accuracy): 0.635066
------------- Clustering (threshold 0.10) ----------
Correlation matrix size (#neurons x #neurons): (9984, 9984)
Number of clusters detected: 5880
Reduced to 5880 neurons
Building model...
Train: (19668, 5880) (19668,)
Dev: (2186, 5880) (2186,)
Test: (2732, 5880) (2732,)
Training classification model
Creating model...
Number of training instances: 19668
Number of classes: 2
Epoch: [1/10], Loss: 0.0154
Epoch: [2/10], Loss: 0.0124
Epoch: [3/10], Loss: 0.0126
Epoch: [4/10], Loss: 0.0126
Epoch: [5/10], Loss: 0.0119
Epoch: [6/10], Loss: 0.0120
Epoch: [7/10], Loss: 0.0118
Epoch: [8/10], Loss: 0.0125
Epoch: [9/10], Loss: 0.0133
Epoch: [10/10], Loss: 0.0129
Score (accuracy) of the model: 0.59
Score (accuracy) of the model: 0.57
Score (accuracy) of the model: 0.54
Results:
Train Score (accuracy): 0.592689
Dev Score (accuracy): 0.569533
Test Score (accuracy): 0.538799
------------- Clustering (threshold 0.20) ----------
Correlation matrix size (#neurons x #neurons): (9984, 9984)
Number of clusters detected: 3905
Reduced to 3905 neurons
Building model...
Train: (19668, 3905) (19668,)
Dev: (2186, 3905) (2186,)
Test: (2732, 3905) (2732,)
Training classification model
Creating model...
Number of training instances: 19668
Number of classes: 2
Epoch: [1/10], Loss: 0.0124
Epoch: [2/10], Loss: 0.0114
Epoch: [3/10], Loss: 0.0113
Epoch: [4/10], Loss: 0.0112
Epoch: [5/10], Loss: 0.0111
Epoch: [6/10], Loss: 0.0110
Epoch: [7/10], Loss: 0.0110
Epoch: [8/10], Loss: 0.0110
Epoch: [9/10], Loss: 0.0109
Epoch: [10/10], Loss: 0.0109
Score (accuracy) of the model: 0.73
Score (accuracy) of the model: 0.72
Score (accuracy) of the model: 0.61
Results:
Train Score (accuracy): 0.728391
Dev Score (accuracy): 0.715005
Test Score (accuracy): 0.610908
------------- Clustering (threshold 0.30) ----------
Correlation matrix size (#neurons x #neurons): (9984, 9984)
Number of clusters detected: 2862
Reduced to 2862 neurons
Building model...
Train: (19668, 2862) (19668,)
Dev: (2186, 2862) (2186,)
Test: (2732, 2862) (2732,)
Training classification model
Creating model...
Number of training instances: 19668
Number of classes: 2
Epoch: [1/10], Loss: 0.0121
Epoch: [2/10], Loss: 0.0107
Epoch: [3/10], Loss: 0.0105
Epoch: [4/10], Loss: 0.0105
Epoch: [5/10], Loss: 0.0104
Epoch: [6/10], Loss: 0.0103
Epoch: [7/10], Loss: 0.0103
Epoch: [8/10], Loss: 0.0103
Epoch: [9/10], Loss: 0.0102
Epoch: [10/10], Loss: 0.0102
Score (accuracy) of the model: 0.73
Score (accuracy) of the model: 0.70
Score (accuracy) of the model: 0.62
Results:
Train Score (accuracy): 0.727629
Dev Score (accuracy): 0.704483
Test Score (accuracy): 0.617130
------------- Clustering (threshold 0.40) ----------
Correlation matrix size (#neurons x #neurons): (9984, 9984)
Number of clusters detected: 2070
Reduced to 2070 neurons
Building model...
Train: (19668, 2070) (19668,)
Dev: (2186, 2070) (2186,)
Test: (2732, 2070) (2732,)
Training classification model
Creating model...
Number of training instances: 19668
Number of classes: 2
Epoch: [1/10], Loss: 0.0121
Epoch: [2/10], Loss: 0.0110
Epoch: [3/10], Loss: 0.0108
Epoch: [4/10], Loss: 0.0107
Epoch: [5/10], Loss: 0.0106
Epoch: [6/10], Loss: 0.0105
Epoch: [7/10], Loss: 0.0105
Epoch: [8/10], Loss: 0.0105
Epoch: [9/10], Loss: 0.0105
Epoch: [10/10], Loss: 0.0104
Score (accuracy) of the model: 0.71
Score (accuracy) of the model: 0.69
Score (accuracy) of the model: 0.61
Results:
Train Score (accuracy): 0.708918
Dev Score (accuracy): 0.690759
Test Score (accuracy): 0.605051
------------- Clustering (threshold 0.50) ----------
Correlation matrix size (#neurons x #neurons): (9984, 9984)
Number of clusters detected: 1443
Reduced to 1443 neurons
Building model...
Train: (19668, 1443) (19668,)
Dev: (2186, 1443) (2186,)
Test: (2732, 1443) (2732,)
Training classification model
Creating model...
Number of training instances: 19668
Number of classes: 2
Epoch: [1/10], Loss: 0.0118
Epoch: [2/10], Loss: 0.0110
Epoch: [3/10], Loss: 0.0108
Epoch: [4/10], Loss: 0.0107
Epoch: [5/10], Loss: 0.0106
Epoch: [6/10], Loss: 0.0106
Epoch: [7/10], Loss: 0.0105
Epoch: [8/10], Loss: 0.0105
Epoch: [9/10], Loss: 0.0105
Epoch: [10/10], Loss: 0.0105
Score (accuracy) of the model: 0.69
Score (accuracy) of the model: 0.67
Score (accuracy) of the model: 0.60
Results:
Train Score (accuracy): 0.692546
Dev Score (accuracy): 0.667429
Test Score (accuracy): 0.598463
------------- Clustering (threshold 0.60) ----------
Correlation matrix size (#neurons x #neurons): (9984, 9984)
Number of clusters detected: 1023
Reduced to 1023 neurons
Building model...
Train: (19668, 1023) (19668,)
Dev: (2186, 1023) (2186,)
Test: (2732, 1023) (2732,)
Training classification model
Creating model...
Number of training instances: 19668
Number of classes: 2
Epoch: [1/10], Loss: 0.0118
Epoch: [2/10], Loss: 0.0111
Epoch: [3/10], Loss: 0.0109
Epoch: [4/10], Loss: 0.0108
Epoch: [5/10], Loss: 0.0107
Epoch: [6/10], Loss: 0.0107
Epoch: [7/10], Loss: 0.0106
Epoch: [8/10], Loss: 0.0106
Epoch: [9/10], Loss: 0.0106
Epoch: [10/10], Loss: 0.0105
Score (accuracy) of the model: 0.66
Score (accuracy) of the model: 0.67
Score (accuracy) of the model: 0.63
Results:
Train Score (accuracy): 0.660870
Dev Score (accuracy): 0.669716
Test Score (accuracy): 0.625915
------------- Clustering (threshold 0.70) ----------
Correlation matrix size (#neurons x #neurons): (9984, 9984)
Number of clusters detected: 600
Reduced to 600 neurons
Building model...
Train: (19668, 600) (19668,)
Dev: (2186, 600) (2186,)
Test: (2732, 600) (2732,)
Training classification model
Creating model...
Number of training instances: 19668
Number of classes: 2
Epoch: [1/10], Loss: 0.0119
Epoch: [2/10], Loss: 0.0111
Epoch: [3/10], Loss: 0.0108
Epoch: [4/10], Loss: 0.0107
Epoch: [5/10], Loss: 0.0106
Epoch: [6/10], Loss: 0.0106
Epoch: [7/10], Loss: 0.0106
Epoch: [8/10], Loss: 0.0105
Epoch: [9/10], Loss: 0.0105
Epoch: [10/10], Loss: 0.0105
Score (accuracy) of the model: 0.63
Score (accuracy) of the model: 0.65
Score (accuracy) of the model: 0.62
Results:
Train Score (accuracy): 0.634940
Dev Score (accuracy): 0.647301
Test Score (accuracy): 0.619693
------------- Clustering (threshold 0.80) ----------
Correlation matrix size (#neurons x #neurons): (9984, 9984)
Number of clusters detected: 263
Reduced to 263 neurons
Building model...
Train: (19668, 263) (19668,)
Dev: (2186, 263) (2186,)
Test: (2732, 263) (2732,)
Training classification model
Creating model...
Number of training instances: 19668
Number of classes: 2
Epoch: [1/10], Loss: 0.0122
Epoch: [2/10], Loss: 0.0117
Epoch: [3/10], Loss: 0.0115
Epoch: [4/10], Loss: 0.0114
Epoch: [5/10], Loss: 0.0114
Epoch: [6/10], Loss: 0.0113
Epoch: [7/10], Loss: 0.0113
Epoch: [8/10], Loss: 0.0113
Epoch: [9/10], Loss: 0.0113
Epoch: [10/10], Loss: 0.0113
Score (accuracy) of the model: 0.63
Score (accuracy) of the model: 0.63
Score (accuracy) of the model: 0.60
Results:
Train Score (accuracy): 0.633262
Dev Score (accuracy): 0.629918
Test Score (accuracy): 0.604685
------------- Clustering (threshold 0.90) ----------
Correlation matrix size (#neurons x #neurons): (9984, 9984)
Number of clusters detected: 32
Reduced to 32 neurons
Building model...
Train: (19668, 32) (19668,)
Dev: (2186, 32) (2186,)
Test: (2732, 32) (2732,)
Training classification model
Creating model...
Number of training instances: 19668
Number of classes: 2
Epoch: [1/10], Loss: 0.0124
Epoch: [2/10], Loss: 0.0124
Epoch: [3/10], Loss: 0.0123
Epoch: [4/10], Loss: 0.0123
Epoch: [5/10], Loss: 0.0123
Epoch: [6/10], Loss: 0.0123
Epoch: [7/10], Loss: 0.0123
Epoch: [8/10], Loss: 0.0123
Epoch: [9/10], Loss: 0.0123
Epoch: [10/10], Loss: 0.0123
Score (accuracy) of the model: 0.55
Score (accuracy) of the model: 0.57
Score (accuracy) of the model: 0.57
Results:
Train Score (accuracy): 0.551658
Dev Score (accuracy): 0.572278
Test Score (accuracy): 0.574671
[MEMORY] After neuron selection: 4266.20
***************************** SUMMARY *****************************
Baseline Score (accuracy): 0.611274
Clustering paramter: no-clustering
Clustering paramter: clustering-0.10
Independent Neurons: 5880 neurons
CC score (accuracy): 0.538799
Clustering paramter: clustering-0.20
Independent Neurons: 3905 neurons
CC score (accuracy): 0.610908
Clustering paramter: clustering-0.30
Independent Neurons: 2862 neurons
CC score (accuracy): 0.617130
Clustering paramter: clustering-0.40
Independent Neurons: 2070 neurons
CC score (accuracy): 0.605051
Clustering paramter: clustering-0.50
Independent Neurons: 1443 neurons
CC score (accuracy): 0.598463
Clustering paramter: clustering-0.60
Independent Neurons: 1023 neurons
CC score (accuracy): 0.625915
Clustering paramter: clustering-0.70
Independent Neurons: 600 neurons
CC score (accuracy): 0.619693
Clustering paramter: clustering-0.80
Independent Neurons: 263 neurons
CC score (accuracy): 0.604685
Clustering paramter: clustering-0.90
Independent Neurons: 32 neurons
CC score (accuracy): 0.574671
