[MEMORY] Begin: 258.72
*********************** LOADING ACTIVATIONS ***********************
[MEMORY] Before activation loading: 258.72
Loading json activations from /work/LAS/jannesar-lab/arushi/Redundancy/Defect-detection/dataset/activations/codegpt/java-adapted/train_activations.json...
21854 13.0
Loading json activations from /work/LAS/jannesar-lab/arushi/Redundancy/Defect-detection/dataset/activations/codegpt/java-adapted/dev_activations.json...
2732 13.0
Number of train sentences: 21854
Number of test sentences: 2732
[MEMORY] After activation loading: 2432.74
************************* LOADING TOKENS **************************
[MEMORY] After token loading: 2439.44
************************ CREATING TENSORS *************************
Train:
Number of tokens:  21854
length of source dictionary:  21854
length of target dictionary:  2
21854
Total instances: 21854
['sentence_16760', 'sentence_12627', 'sentence_7747', 'sentence_3923', 'sentence_5838', 'sentence_12709', 'sentence_20344', 'sentence_6636', 'sentence_20995', 'sentence_11742', 'sentence_704', 'sentence_18260', 'sentence_5756', 'sentence_15403', 'sentence_3673', 'sentence_837', 'sentence_11872', 'sentence_12031', 'sentence_8504', 'sentence_2324']
(19668, 9984) (19668,)
Dev:
(2186, 9984) (2186,)
Test:
Number of tokens:  2732
length of source dictionary:  21854
length of target dictionary:  2
2732
Total instances: 2732
['sentence_1724', 'sentence_1811', 'sentence_992', 'sentence_49', 'sentence_1501', 'sentence_917', 'sentence_2132', 'sentence_1828', 'sentence_79', 'sentence_1726', 'sentence_2433', 'sentence_592', 'sentence_146', 'sentence_2348', 'sentence_816', 'sentence_237', 'sentence_2512', 'sentence_704', 'sentence_671', 'sentence_1097']
(2732, 9984) (2732,)
[MEMORY] After tensor creation: 4217.05
************************* FREEING MEMORY **************************
[MEMORY] After cleanup: 4213.47
***************** RUNNING BASELINE [ ALL LAYERS ] *****************
Building model...
Train: (19668, 9984) (19668,)
Dev: (2186, 9984) (2186,)
Test: (2732, 9984) (2732,)
Training classification model
Creating model...
Number of training instances: 19668
Number of classes: 2
Epoch: [1/10], Loss: 0.0222
Epoch: [2/10], Loss: 0.0199
Epoch: [3/10], Loss: 0.0182
Epoch: [4/10], Loss: 0.0156
Epoch: [5/10], Loss: 0.0175
Epoch: [6/10], Loss: 0.0190
Epoch: [7/10], Loss: 0.0167
Epoch: [8/10], Loss: 0.0162
Epoch: [9/10], Loss: 0.0181
Epoch: [10/10], Loss: 0.0182
Score (accuracy) of the model: 0.62
Score (accuracy) of the model: 0.61
Score (accuracy) of the model: 0.55
Results:
Train Score (accuracy): 0.620856
Dev Score (accuracy): 0.605215
Test Score (accuracy): 0.546486
[MEMORY] After baseline run: 4230.94
********************* RUNNING NEURON SELECTION *********************
------------- Clustering (threshold -1.00) ----------
Building model...
Train: (19668, 9984) (19668,)
Dev: (2186, 9984) (2186,)
Test: (2732, 9984) (2732,)
Training classification model
Creating model...
Number of training instances: 19668
Number of classes: 2
Epoch: [1/10], Loss: 0.0228
Epoch: [2/10], Loss: 0.0218
Epoch: [3/10], Loss: 0.0164
Epoch: [4/10], Loss: 0.0179
Epoch: [5/10], Loss: 0.0176
Epoch: [6/10], Loss: 0.0203
Epoch: [7/10], Loss: 0.0176
Epoch: [8/10], Loss: 0.0154
Epoch: [9/10], Loss: 0.0182
Epoch: [10/10], Loss: 0.0158
Score (accuracy) of the model: 0.72
Score (accuracy) of the model: 0.66
Score (accuracy) of the model: 0.60
Results:
Train Score (accuracy): 0.718477
Dev Score (accuracy): 0.660567
Test Score (accuracy): 0.598463
Gold score (Baseline with selected top layer [and potential clustering]): 0.660567
Target score (1% drop): 0.653962
Getting neuron ranking...
Searching for minimal neuron set...
------------- Retraining with 9 neurons (0.10% of total) -------------
Building model...
Train: (19668, 9) (19668,)
Dev: (2186, 9) (2186,)
Test: (2732, 9) (2732,)
Training classification model
Creating model...
Number of training instances: 19668
Number of classes: 2
Epoch: [1/10], Loss: 0.0122
Epoch: [2/10], Loss: 0.0117
Epoch: [3/10], Loss: 0.0116
Epoch: [4/10], Loss: 0.0116
Epoch: [5/10], Loss: 0.0116
Epoch: [6/10], Loss: 0.0116
Epoch: [7/10], Loss: 0.0116
Epoch: [8/10], Loss: 0.0116
Epoch: [9/10], Loss: 0.0116
Epoch: [10/10], Loss: 0.0116
Score (accuracy) of the model: 0.61
Score (accuracy) of the model: 0.62
Score (accuracy) of the model: 0.58
Results:
Train Score (accuracy): 0.612721
Dev Score (accuracy): 0.621226
Test Score (accuracy): 0.580161
------------- Retraining with 19 neurons (0.20% of total) -------------
Building model...
Train: (19668, 19) (19668,)
Dev: (2186, 19) (2186,)
Test: (2732, 19) (2732,)
Training classification model
Creating model...
Number of training instances: 19668
Number of classes: 2
Epoch: [1/10], Loss: 0.0118
Epoch: [2/10], Loss: 0.0112
Epoch: [3/10], Loss: 0.0111
Epoch: [4/10], Loss: 0.0111
Epoch: [5/10], Loss: 0.0111
Epoch: [6/10], Loss: 0.0111
Epoch: [7/10], Loss: 0.0111
Epoch: [8/10], Loss: 0.0111
Epoch: [9/10], Loss: 0.0111
Epoch: [10/10], Loss: 0.0111
Score (accuracy) of the model: 0.64
Score (accuracy) of the model: 0.63
Score (accuracy) of the model: 0.60
Results:
Train Score (accuracy): 0.639618
Dev Score (accuracy): 0.634950
Test Score (accuracy): 0.603587
------------- Retraining with 29 neurons (0.30% of total) -------------
Building model...
Train: (19668, 29) (19668,)
Dev: (2186, 29) (2186,)
Test: (2732, 29) (2732,)
Training classification model
Creating model...
Number of training instances: 19668
Number of classes: 2
Epoch: [1/10], Loss: 0.0113
Epoch: [2/10], Loss: 0.0107
Epoch: [3/10], Loss: 0.0106
Epoch: [4/10], Loss: 0.0106
Epoch: [5/10], Loss: 0.0106
Epoch: [6/10], Loss: 0.0106
Epoch: [7/10], Loss: 0.0106
Epoch: [8/10], Loss: 0.0106
Epoch: [9/10], Loss: 0.0106
Epoch: [10/10], Loss: 0.0106
Score (accuracy) of the model: 0.67
Score (accuracy) of the model: 0.68
Score (accuracy) of the model: 0.61
Results:
Train Score (accuracy): 0.666870
Dev Score (accuracy): 0.683440
Test Score (accuracy): 0.608712
[MEMORY] After neuron selection: 4231.12
***************************** SUMMARY *****************************
Baseline Score (accuracy): 0.546486
Clustering paramter: no-clustering
Minimal set of neurons: 29 neurons
Minimal set score (accuracy): 0.608712
